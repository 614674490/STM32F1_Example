##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32               15/May/2008  12:06:34 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  thumb                                                #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM        #
#                       Encoder\example\FWLib\src\stm32f10x_tim1.c           #
#    Command line    =  "C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM       #
#                       Encoder\example\FWLib\src\stm32f10x_tim1.c" -D       #
#                       VECT_TAB_FLASH -lcN "C:\David JIANG\ST               #
#                       MCU\Docs\STM32\AN_JIANG\TIM                          #
#                       Encoder\example\project\EWARM\BOOT_FLASH\List\" -lb  #
#                       "C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM       #
#                       Encoder\example\project\EWARM\BOOT_FLASH\List\" -o   #
#                       "C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM       #
#                       Encoder\example\project\EWARM\BOOT_FLASH\Obj\" -z3   #
#                       --no_cse --no_unroll --no_inline --no_code_motion    #
#                       --no_tbaa --no_clustering --no_scheduling --debug    #
#                       --cpu_mode thumb --endian little --cpu cortex-M3     #
#                       --stack_align 4 --require_prototypes --fpu None      #
#                       --dlib_config "C:\Program Files\IAR                  #
#                       Systems\Embedded Workbench                           #
#                       4.0\arm\LIB\dl7mptnnl8f.h" -I "C:\David JIANG\ST     #
#                       MCU\Docs\STM32\AN_JIANG\TIM                          #
#                       Encoder\example\project\EWARM\" -I "C:\David         #
#                       JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM                 #
#                       Encoder\example\project\EWARM\..\include\" -I        #
#                       "C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM       #
#                       Encoder\example\project\EWARM\..\..\FWLib\inc\" -I   #
#                       "C:\Program Files\IAR Systems\Embedded Workbench     #
#                       4.0\arm\INC\"                                        #
#    List file       =  C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM        #
#                       Encoder\example\project\EWARM\BOOT_FLASH\List\stm32f #
#                       10x_tim1.lst                                         #
#    Object file     =  C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM        #
#                       Encoder\example\project\EWARM\BOOT_FLASH\Obj\stm32f1 #
#                       0x_tim1.r79                                          #
#                                                                            #
#                                                                            #
##############################################################################

C:\David JIANG\ST MCU\Docs\STM32\AN_JIANG\TIM Encoder\example\FWLib\src\stm32f10x_tim1.c
      1          /******************** (C) COPYRIGHT 2007 STMicroelectronics ********************
      2          * File Name          : stm32f10x_tim1.c
      3          * Author             : MCD Application Team
      4          * Date First Issued  : 09/29/2006
      5          * Description        : This file provides all the TIM1 software functions.
      6          ********************************************************************************
      7          * History:
      8          * 05/21/2007: V0.3
      9          * 04/02/2007: V0.2
     10          * 02/05/2007: V0.1
     11          * 09/29/2006: V0.01
     12          ********************************************************************************
     13          * THE PRESENT SOFTWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
     14          * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE TIME.
     15          * AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY DIRECT,
     16          * INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING FROM THE
     17          * CONTENT OF SUCH SOFTWARE AND/OR THE USE MADE BY CUSTOMERS OF THE CODING
     18          * INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
     19          *******************************************************************************/
     20          
     21          /* Includes ------------------------------------------------------------------*/
     22          #include "stm32f10x_tim1.h"
     23          #include "stm32f10x_rcc.h"
     24          
     25          /* Private typedef -----------------------------------------------------------*/
     26          /* Private define ------------------------------------------------------------*/
     27          
     28          /* ------------ TIM1 registers bit address in the alias region ----------- */
     29          #define TIM1_OFFSET    (TIM1_BASE - PERIPH_BASE)
     30          
     31          /* --- TIM1 CR1 Register ---*/
     32          /* Alias word address of CEN bit */
     33          #define CR1_OFFSET        (TIM1_OFFSET + 0x00)
     34          #define CEN_BitNumber     0x00
     35          #define CR1_CEN_BB        (PERIPH_BB_BASE + (CR1_OFFSET * 32) + (CEN_BitNumber * 4))
     36          
     37          /* Alias word address of UDIS bit */
     38          #define UDIS_BitNumber    0x01
     39          #define CR1_UDIS_BB       (PERIPH_BB_BASE + (CR1_OFFSET * 32) + (UDIS_BitNumber * 4))
     40          
     41          /* Alias word address of URS bit */
     42          #define URS_BitNumber     0x02
     43          #define CR1_URS_BB        (PERIPH_BB_BASE + (CR1_OFFSET * 32) + (URS_BitNumber * 4))
     44          
     45          /* Alias word address of OPM bit */
     46          #define OPM_BitNumber     0x03
     47          #define CR1_OPM_BB        (PERIPH_BB_BASE + (CR1_OFFSET * 32) + (OPM_BitNumber * 4))
     48          
     49          /* Alias word address of ARPE bit */
     50          #define ARPE_BitNumber    0x07
     51          #define CR1_ARPE_BB       (PERIPH_BB_BASE + (CR1_OFFSET * 32) + (ARPE_BitNumber * 4))
     52          
     53          /* --- TIM1 CR2 Register --- */
     54          /* Alias word address of CCPC bit */
     55          #define CR2_OFFSET        (TIM1_OFFSET + 0x04)
     56          #define CCPC_BitNumber    0x00
     57          #define CR2_CCPC_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (CCPC_BitNumber * 4))
     58          
     59          /* Alias word address of CCUS bit */
     60          #define CCUS_BitNumber    0x02
     61          #define CR2_CCUS_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (CCUS_BitNumber * 4))
     62          
     63          /* Alias word address of CCDS bit */
     64          #define CCDS_BitNumber    0x03
     65          #define CR2_CCDS_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (CCDS_BitNumber * 4))
     66          
     67          /* Alias word address of TI1S bit */
     68          #define TI1S_BitNumber    0x07
     69          #define CR2_TI1S_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (TI1S_BitNumber * 4))
     70          
     71          /* Alias word address of OIS1 bit */
     72          #define OIS1_BitNumber    0x08
     73          #define CR2_OIS1_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS1_BitNumber * 4))
     74          
     75          /* Alias word address of OIS1N bit */
     76          #define OIS1N_BitNumber   0x09
     77          #define CR2_OIS1N_BB      (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS1N_BitNumber * 4))
     78          
     79          /* Alias word address of OIS2 bit */
     80          #define OIS2_BitNumber    0x0A
     81          #define CR2_OIS2_BB      (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS2_BitNumber * 4))
     82          
     83          /* Alias word address of OIS2N bit */
     84          #define OIS2N_BitNumber   0x0B
     85          #define CR2_OIS2N_BB      (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS2N_BitNumber * 4))
     86          
     87          /* Alias word address of OIS3 bit */
     88          #define OIS3_BitNumber    0x0C
     89          #define CR2_OIS3_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS3_BitNumber * 4))
     90          
     91          /* Alias word address of OIS3N bit */
     92          #define OIS3N_BitNumber   0x0D
     93          #define CR2_OIS3N_BB      (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS3N_BitNumber * 4))
     94          
     95          /* Alias word address of OIS4 bit */
     96          #define OIS4_BitNumber    0x0E
     97          #define CR2_OIS4_BB       (PERIPH_BB_BASE + (CR2_OFFSET * 32) + (OIS4_BitNumber * 4))
     98          
     99          /* --- TIM1 SMCR Register --- */
    100          /* Alias word address of MSM bit */
    101          #define SMCR_OFFSET       (TIM1_OFFSET + 0x08)
    102          #define MSM_BitNumber     0x07
    103          #define SMCR_MSM_BB       (PERIPH_BB_BASE + (SMCR_OFFSET * 32) + (MSM_BitNumber * 4))
    104          
    105          /* Alias word address of ECE bit */
    106          #define ECE_BitNumber     0x0E
    107          #define SMCR_ECE_BB       (PERIPH_BB_BASE + (SMCR_OFFSET * 32) + (ECE_BitNumber * 4))
    108          
    109          /* --- TIM1 EGR Register --- */
    110          /* Alias word address of UG bit */
    111          #define EGR_OFFSET        (TIM1_OFFSET + 0x14)
    112          #define UG_BitNumber      0x00
    113          #define EGR_UG_BB         (PERIPH_BB_BASE + (EGR_OFFSET * 32) + (UG_BitNumber * 4))
    114          
    115          /* --- TIM1 CCER Register --- */
    116          /* Alias word address of CC1E bit */
    117          #define CCER_OFFSET       (TIM1_OFFSET + 0x20)
    118          #define CC1E_BitNumber    0x00
    119          #define CCER_CC1E_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC1E_BitNumber * 4))
    120          
    121          /* Alias word address of CC1P bit */
    122          #define CC1P_BitNumber    0x01
    123          #define CCER_CC1P_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC1P_BitNumber * 4))
    124          
    125          /* Alias word address of CC1NE bit */
    126          #define CC1NE_BitNumber   0x02
    127          #define CCER_CC1NE_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC1NE_BitNumber * 4))
    128          
    129          /* Alias word address of CC1NP bit */
    130          #define CC1NP_BitNumber   0x03
    131          #define CCER_CC1NP_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC1NP_BitNumber * 4))
    132          
    133          /* Alias word address of CC2E bit */
    134          #define CC2E_BitNumber    0x04
    135          #define CCER_CC2E_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC2E_BitNumber * 4))
    136          
    137          /* Alias word address of CC2P bit */
    138          #define CC2P_BitNumber    0x05
    139          #define CCER_CC2P_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC2P_BitNumber * 4))
    140          
    141          /* Alias word address of CC2NE bit */
    142          #define CC2NE_BitNumber   0x06
    143          #define CCER_CC2NE_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC2NE_BitNumber * 4))
    144          
    145          /* Alias word address of CC2NP bit */
    146          #define CC2NP_BitNumber   0x07
    147          #define CCER_CC2NP_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC2NP_BitNumber * 4))
    148          
    149          /* Alias word address of CC3E bit */
    150          #define CC3E_BitNumber    0x08
    151          #define CCER_CC3E_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC3E_BitNumber * 4))
    152          
    153          /* Alias word address of CC3P bit */
    154          #define CC3P_BitNumber    0x09
    155          #define CCER_CC3P_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC3P_BitNumber * 4))
    156          
    157          /* Alias word address of CC3NE bit */
    158          #define CC3NE_BitNumber   0x0A
    159          #define CCER_CC3NE_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC3NE_BitNumber * 4))
    160          
    161          /* Alias word address of CC3NP bit */
    162          #define CC3NP_BitNumber   0x0B
    163          #define CCER_CC3NP_BB     (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC3NP_BitNumber * 4))
    164          
    165          /* Alias word address of CC4E bit */
    166          #define CC4E_BitNumber    0x0C
    167          #define CCER_CC4E_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC4E_BitNumber * 4))
    168          
    169          /* Alias word address of CC4P bit */
    170          #define CC4P_BitNumber    0x0D
    171          #define CCER_CC4P_BB      (PERIPH_BB_BASE + (CCER_OFFSET * 32) + (CC4P_BitNumber * 4))
    172          
    173          /* --- TIM1 BDTR Register --- */
    174          /* Alias word address of MOE bit */
    175          #define BDTR_OFFSET       (TIM1_OFFSET + 0x44)
    176          #define MOE_BitNumber     0x0F
    177          #define BDTR_MOE_BB       (PERIPH_BB_BASE + (BDTR_OFFSET * 32) + (MOE_BitNumber * 4))
    178          
    179          /* --- TIM1 CCMR1 Register --- */
    180          /* Alias word address of OC1FE bit */
    181          #define CCMR1_OFFSET      (TIM1_OFFSET + 0x18)
    182          #define OC1FE_BitNumber   0x02
    183          #define CCMR1_OC1FE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC1FE_BitNumber * 4))
    184          
    185          /* Alias word address of OC1PE bit */
    186          #define OC1PE_BitNumber   0x03
    187          #define CCMR1_OC1PE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC1PE_BitNumber * 4))
    188          
    189          /* Alias word address of OC1CE bit */
    190          #define OC1CE_BitNumber   0x07
    191          #define CCMR1_OC1CE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC1CE_BitNumber * 4))
    192          
    193          /* Alias word address of OC2FE bit */
    194          #define OC2FE_BitNumber   0x0A
    195          #define CCMR1_OC2FE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC2FE_BitNumber * 4))
    196          
    197          /* Alias word address of OC2PE bit */
    198          #define OC2PE_BitNumber   0x0B
    199          #define CCMR1_OC2PE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC2PE_BitNumber * 4))
    200          
    201          /* Alias word address of OC2CE bit */
    202          #define OC2CE_BitNumber   0x0F
    203          #define CCMR1_OC2CE_BB    (PERIPH_BB_BASE + (CCMR1_OFFSET * 32) + (OC2CE_BitNumber * 4))
    204          
    205          /* --- TIM1 CCMR2 Register ---- */
    206          /* Alias word address of OC3FE bit */
    207          #define CCMR2_OFFSET      (TIM1_OFFSET + 0x1C)
    208          #define OC3FE_BitNumber   0x02
    209          #define CCMR2_OC3FE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC3FE_BitNumber * 4))
    210          
    211          /* Alias word address of OC3PE bit */
    212          #define OC3PE_BitNumber   0x03
    213          #define CCMR2_OC3PE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC3PE_BitNumber * 4))
    214          
    215          /* Alias word address of OC3CE bit */
    216          #define OC3CE_BitNumber   0x07
    217          #define CCMR2_OC3CE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC3CE_BitNumber * 4))
    218          
    219          /* Alias word address of OC4FE bit */
    220          #define OC4FE_BitNumber   0x0A
    221          #define CCMR2_OC4FE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC4FE_BitNumber * 4))
    222          
    223          /* Alias word address of OC4PE bit */
    224          #define OC4PE_BitNumber   0x0B
    225          #define CCMR2_OC4PE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC4PE_BitNumber * 4))
    226          
    227          /* Alias word address of OC4CE bit */
    228          #define OC4CE_BitNumber   0x0F
    229          #define CCMR2_OC4CE_BB    (PERIPH_BB_BASE + (CCMR2_OFFSET * 32) + (OC4CE_BitNumber * 4))
    230          
    231          /* --------------------- TIM1 registers bit mask ------------------------- */
    232          /* TIM1 CR1 Mask */
    233          #define CR1_CounterMode_Mask                ((u16)0x039F)
    234          #define CR1_CKD_Mask                        ((u16)0x00FF)
    235          
    236          /* TIM1 CR2 Mask */
    237          #define CR2_MMS_Mask                        ((u16)0x0080)
    238          
    239          /* TIM1 SMCR Mask */
    240          #define SMCR_SMS_Mask                       ((u16)0xFFF0)
    241          #define SMCR_ETR_Mask                       ((u16)0x40F7)
    242          #define SMCR_TS_Mask                        ((u16)0xFF87)
    243          #define SMCR_ECE_Set                        ((u16)0x0001)
    244          
    245          /* TIM1 CCMRx Mask */
    246          #define CCMR_CC13S_Mask                     ((u16)0xFFFC)
    247          #define CCMR_CC24S_Mask                     ((u16)0xFCFF)
    248          #define CCMR_TI13Direct_Set                 ((u16)0x0001)
    249          #define CCMR_TI24Direct_Set                 ((u16)0x0100)
    250          #define CCMR_OCM13_Mask                     ((u16)0x7F0F)
    251          #define CCMR_OCM24_Mask                     ((u16)0x0F7F)
    252          #define CCMR_IC13PSC_Mask                   ((u16)0xFFF3)
    253          #define CCMR_IC24PSC_Mask                   ((u16)0xF3FF)
    254          #define CCMR_IC13F_Mask                     ((u16)0xFF0F)
    255          #define CCMR_IC24F_Mask                     ((u16)0x0FFF)
    256          #define OC13Mode_Mask		                ((u16)0xFF00)
    257          #define OC24Mode_Mask		                ((u16)0x00FF)
    258          
    259          /* TIM1 CCER Set/Reset Bit */
    260          #define CCER_CCE_Set                        ((u16)0x0001)
    261          #define CCER_CCE_Reset                      ((u16)0x0000)
    262          
    263          /* TIM1 DMA Mask */
    264          #define DCR_DMA_Mask                        ((u16)0x0000)
    265          
    266          /* TIM1 private Masks */
    267          #define TIM1_Period_Reset_Mask               ((u16)0xFFFF)
    268          #define TIM1_Prescaler_Reset_Mask            ((u16)0x0000)
    269          #define TIM1_RepetitionCounter_Reset_Mask    ((u16)0x0000)
    270          #define TIM1_Pulse_Reset_Mask                ((u16)0x0000)
    271          #define TIM1_ICFilter_Mask                   ((u8)0x00)
    272          #define TIM1_DeadTime_Reset_Mask             ((u16)0x0000)
    273          
    274          /* Private macro -------------------------------------------------------------*/
    275          /* Private variables ---------------------------------------------------------*/
    276          /* Private function prototypes -----------------------------------------------*/
    277          static void TI1_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
    278                                 u8 TIM1_ICFilter);
    279          static void TI2_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
    280                                 u8 TIM1_ICFilter);
    281          static void TI3_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
    282                                 u8 TIM1_ICFilter);
    283          static void TI4_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
    284                                 u8 TIM1_ICFilter);
    285          
    286          /*******************************************************************************
    287          * Function Name  : TIM1_DeInit
    288          * Description    : Deinitializes the TIM1 peripheral registers to their default
    289          *                  reset values.
    290          * Input          : None
    291          * Output         : None
    292          * Return         : None
    293          *******************************************************************************/
    294          void TIM1_DeInit(void)
    295          {
    296            RCC_APB2PeriphResetCmd(RCC_APB2Periph_TIM1, ENABLE);
    297            RCC_APB2PeriphResetCmd(RCC_APB2Periph_TIM1, DISABLE);
    298          }
    299          
    300          /*******************************************************************************
    301          * Function Name  : TIM1_TimeBaseInit
    302          * Description    : Initializes the TIM1 Time Base Unit according to the specified
    303          *                  parameters in the TIM1_TimeBaseInitStruct.
    304          * Input          : - TIM1_TimeBaseInitStruct: pointer to a TIM1_TimeBaseInitTypeDef
    305          *                    structure that contains the configuration information for
    306          *                    the specified TIM1 peripheral.
    307          * Output         : None
    308          * Return         : None
    309          *******************************************************************************/
    310          void TIM1_TimeBaseInit(TIM1_TimeBaseInitTypeDef* TIM1_TimeBaseInitStruct)
    311          {
    312           /* Check the parameters */
    313            assert(IS_TIM1_COUNTER_MODE(TIM1_TimeBaseInitStruct->TIM1_CounterMode));
    314            assert(IS_TIM1_CKD_DIV(TIM1_TimeBaseInitStruct->TIM1_ClockDivision));
    315          
    316            /* Set the Autoreload value */
    317            TIM1->ARR = TIM1_TimeBaseInitStruct->TIM1_Period ;
    318          
    319            /* Set the Prescaler value */
    320            TIM1->PSC = TIM1_TimeBaseInitStruct->TIM1_Prescaler;
    321          
    322            /* Select the Counter Mode and set the clock division */
    323            TIM1->CR1 &= CR1_CKD_Mask & CR1_CounterMode_Mask;
    324            TIM1->CR1 |= (u32)TIM1_TimeBaseInitStruct->TIM1_ClockDivision |
    325                         TIM1_TimeBaseInitStruct->TIM1_CounterMode;
    326          
    327            /* Set the Repetition Counter value */
    328            TIM1->RCR = TIM1_TimeBaseInitStruct->TIM1_RepetitionCounter;
    329          }
    330          
    331          /*******************************************************************************
    332          * Function Name  : TIM1_OC1Init
    333          * Description    : Initializes the TIM1 Channel1 according to the specified
    334          *                  parameters in the TIM1_OCInitStruct.
    335          * Input          : - TIM1_OCInitStruct: pointer to a TIM1_OCInitTypeDef structure that
    336          *                    contains the configuration information for the TIM1 peripheral.
    337          * Output         : None
    338          * Return         : None
    339          *******************************************************************************/
    340          void TIM1_OC1Init(TIM1_OCInitTypeDef* TIM1_OCInitStruct)
    341          {
    342            u16 tmpccmr = 0;
    343          
    344            /* Check the parameters */
    345            assert(IS_TIM1_OC_MODE(TIM1_OCInitStruct->TIM1_OCMode));
    346            assert(IS_TIM1_OUTPUT_STATE(TIM1_OCInitStruct->TIM1_OutputState));
    347            assert(IS_TIM1_OUTPUTN_STATE(TIM1_OCInitStruct->TIM1_OutputNState));
    348            assert(IS_TIM1_OC_POLARITY(TIM1_OCInitStruct->TIM1_OCPolarity));
    349            assert(IS_TIM1_OCN_POLARITY(TIM1_OCInitStruct->TIM1_OCNPolarity));
    350            assert(IS_TIM1_OCIDLE_STATE(TIM1_OCInitStruct->TIM1_OCIdleState));
    351            assert(IS_TIM1_OCNIDLE_STATE(TIM1_OCInitStruct->TIM1_OCNIdleState)); 
    352          
    353            tmpccmr = TIM1->CCMR1;
    354          
    355            /* Disable the Channel 1: Reset the CCE Bit */
    356            *(vu32 *) CCER_CC1E_BB = CCER_CCE_Reset;
    357          
    358            /* Reset the Output Compare Bits */
    359             tmpccmr &= OC13Mode_Mask;
    360          
    361            /* Set the Ouput Compare Mode */
    362            tmpccmr |= TIM1_OCInitStruct->TIM1_OCMode;
    363          
    364            TIM1->CCMR1 = tmpccmr;
    365          
    366            /* Set the Output State */
    367            *(vu32 *) CCER_CC1E_BB = TIM1_OCInitStruct->TIM1_OutputState;
    368          
    369            /* Set the Output N State */
    370            *(vu32 *) CCER_CC1NE_BB = TIM1_OCInitStruct->TIM1_OutputNState;
    371          
    372            /* Set the Output Polarity */
    373            *(vu32 *) CCER_CC1P_BB = TIM1_OCInitStruct->TIM1_OCPolarity;
    374          
    375            /* Set the Output N Polarity */
    376            *(vu32 *) CCER_CC1NP_BB = TIM1_OCInitStruct->TIM1_OCNPolarity;
    377          
    378            /* Set the Output Idle state */
    379            *(vu32 *) CR2_OIS1_BB = TIM1_OCInitStruct->TIM1_OCIdleState;
    380          
    381            /* Set the Output N Idle state */
    382            *(vu32 *) CR2_OIS1N_BB = TIM1_OCInitStruct->TIM1_OCNIdleState;
    383          
    384            /* Set the Pulse value */
    385            TIM1->CCR1 = TIM1_OCInitStruct->TIM1_Pulse;
    386          }
    387          
    388          /*******************************************************************************
    389          * Function Name  : TIM1_OC2Init
    390          * Description    : Initializes the TIM1 Channel2 according to the specified
    391          *                  parameters in the TIM1_OCInitStruct.
    392          * Input          : - TIM1_OCInitStruct: pointer to a TIM1_OCInitTypeDef structure that
    393          *                    contains the configuration information for the TIM1 peripheral.
    394          * Output         : None
    395          * Return         : None
    396          *******************************************************************************/
    397          void TIM1_OC2Init(TIM1_OCInitTypeDef* TIM1_OCInitStruct)
    398          {
    399            u32 tmpccmr = 0;
    400          
    401            /* Check the parameters */
    402            assert(IS_TIM1_OC_MODE(TIM1_OCInitStruct->TIM1_OCMode));
    403            assert(IS_TIM1_OUTPUT_STATE(TIM1_OCInitStruct->TIM1_OutputState));
    404            assert(IS_TIM1_OUTPUTN_STATE(TIM1_OCInitStruct->TIM1_OutputNState));
    405            assert(IS_TIM1_OC_POLARITY(TIM1_OCInitStruct->TIM1_OCPolarity));
    406            assert(IS_TIM1_OCN_POLARITY(TIM1_OCInitStruct->TIM1_OCNPolarity));
    407            assert(IS_TIM1_OCIDLE_STATE(TIM1_OCInitStruct->TIM1_OCIdleState));
    408            assert(IS_TIM1_OCNIDLE_STATE(TIM1_OCInitStruct->TIM1_OCNIdleState));
    409          
    410            tmpccmr = TIM1->CCMR1;
    411          
    412            /* Disable the Channel 2: Reset the CCE Bit */
    413            *(vu32 *) CCER_CC2E_BB = CCER_CCE_Reset;
    414          
    415            /* Reset the Output Compare Bits */
    416             tmpccmr &= OC24Mode_Mask;
    417          
    418            /* Set the Ouput Compare Mode */
    419            tmpccmr |= (u32)TIM1_OCInitStruct->TIM1_OCMode << 8;
    420          
    421            TIM1->CCMR1 = (u16)tmpccmr;
    422          
    423            /* Set the Output State */
    424            *(vu32 *) CCER_CC2E_BB = TIM1_OCInitStruct->TIM1_OutputState;
    425          
    426            /* Set the Output N State */
    427            *(vu32 *) CCER_CC2NE_BB = TIM1_OCInitStruct->TIM1_OutputNState;
    428          
    429            /* Set the Output Polarity */
    430            *(vu32 *) CCER_CC2P_BB = TIM1_OCInitStruct->TIM1_OCPolarity;
    431          
    432            /* Set the Output N Polarity */
    433            *(vu32 *) CCER_CC2NP_BB = TIM1_OCInitStruct->TIM1_OCNPolarity;
    434          
    435            /* Set the Output Idle state */
    436            *(vu32 *) CR2_OIS2_BB = TIM1_OCInitStruct->TIM1_OCIdleState;
    437          
    438            /* Set the Output N Idle state */
    439            *(vu32 *) CR2_OIS2N_BB = TIM1_OCInitStruct->TIM1_OCNIdleState;
    440          
    441            /* Set the Pulse value */
    442            TIM1->CCR2 = TIM1_OCInitStruct->TIM1_Pulse;
    443          }
    444          
    445          /*******************************************************************************
    446          * Function Name  : TIM1_OC3Init
    447          * Description    : Initializes the TIM1 Channel3 according to the specified
    448          *                  parameters in the TIM1_OCInitStruct.
    449          * Input          : - TIM1_OCInitStruct: pointer to a TIM1_OCInitTypeDef structure that
    450          *                    contains the configuration information for the TIM1 peripheral.
    451          * Output         : None
    452          * Return         : None
    453          *******************************************************************************/
    454          void TIM1_OC3Init(TIM1_OCInitTypeDef* TIM1_OCInitStruct)
    455          {
    456            u16 tmpccmr = 0;
    457          
    458            /* Check the parameters */
    459            assert(IS_TIM1_OC_MODE(TIM1_OCInitStruct->TIM1_OCMode));
    460            assert(IS_TIM1_OUTPUT_STATE(TIM1_OCInitStruct->TIM1_OutputState));
    461            assert(IS_TIM1_OUTPUTN_STATE(TIM1_OCInitStruct->TIM1_OutputNState));
    462            assert(IS_TIM1_OC_POLARITY(TIM1_OCInitStruct->TIM1_OCPolarity));
    463            assert(IS_TIM1_OCN_POLARITY(TIM1_OCInitStruct->TIM1_OCNPolarity));
    464            assert(IS_TIM1_OCIDLE_STATE(TIM1_OCInitStruct->TIM1_OCIdleState));
    465            assert(IS_TIM1_OCNIDLE_STATE(TIM1_OCInitStruct->TIM1_OCNIdleState));
    466          
    467            tmpccmr = TIM1->CCMR2;
    468          
    469            /* Disable the Channel 3: Reset the CCE Bit */
    470            *(vu32 *) CCER_CC3E_BB = CCER_CCE_Reset;
    471          
    472            /* Reset the Output Compare Bits */
    473             tmpccmr &= OC13Mode_Mask;
    474          
    475            /* Set the Ouput Compare Mode */
    476            tmpccmr |= TIM1_OCInitStruct->TIM1_OCMode;
    477          
    478            TIM1->CCMR2 = tmpccmr;
    479          
    480            /* Set the Output State */
    481            *(vu32 *) CCER_CC3E_BB = TIM1_OCInitStruct->TIM1_OutputState;
    482          
    483            /* Set the Output N State */
    484            *(vu32 *) CCER_CC3NE_BB = TIM1_OCInitStruct->TIM1_OutputNState;
    485          
    486            /* Set the Output Polarity */
    487            *(vu32 *) CCER_CC3P_BB = TIM1_OCInitStruct->TIM1_OCPolarity;
    488          
    489            /* Set the Output N Polarity */
    490            *(vu32 *) CCER_CC3NP_BB = TIM1_OCInitStruct->TIM1_OCNPolarity;
    491          
    492            /* Set the Output Idle state */
    493            *(vu32 *) CR2_OIS3_BB = TIM1_OCInitStruct->TIM1_OCIdleState;
    494          
    495            /* Set the Output N Idle state */
    496            *(vu32 *) CR2_OIS3N_BB = TIM1_OCInitStruct->TIM1_OCNIdleState;
    497          
    498            /* Set the Pulse value */
    499            TIM1->CCR3 = TIM1_OCInitStruct->TIM1_Pulse;
    500          }
    501          
    502          /*******************************************************************************
    503          * Function Name  : TIM1_OC4Init
    504          * Description    : Initializes the TIM1 Channel4 according to the specified
    505          *                  parameters in the TIM1_OCInitStruct.
    506          * Input          : - TIM1_OCInitStruct: pointer to a TIM1_OCInitTypeDef structure that
    507          *                    contains the configuration information for the TIM1 peripheral.
    508          * Output         : None
    509          * Return         : None
    510          *******************************************************************************/
    511          void TIM1_OC4Init(TIM1_OCInitTypeDef* TIM1_OCInitStruct)
    512          {
    513            u32 tmpccmr = 0;
    514          
    515            /* Check the parameters */
    516            assert(IS_TIM1_OC_MODE(TIM1_OCInitStruct->TIM1_OCMode));
    517            assert(IS_TIM1_OUTPUT_STATE(TIM1_OCInitStruct->TIM1_OutputState));
    518            assert(IS_TIM1_OC_POLARITY(TIM1_OCInitStruct->TIM1_OCPolarity));
    519            assert(IS_TIM1_OCIDLE_STATE(TIM1_OCInitStruct->TIM1_OCIdleState));
    520          
    521            tmpccmr = TIM1->CCMR2;
    522          
    523            /* Disable the Channel 4: Reset the CCE Bit */
    524            *(vu32 *) CCER_CC4E_BB = CCER_CCE_Reset;
    525          
    526            /* Reset the Output Compare Bits */
    527             tmpccmr &= OC24Mode_Mask;
    528          
    529            /* Set the Ouput Compare Mode */
    530            tmpccmr |= (u32)TIM1_OCInitStruct->TIM1_OCMode << 8;
    531          
    532            TIM1->CCMR2 = (u16)tmpccmr;
    533          
    534            /* Set the Output State */
    535            *(vu32 *) CCER_CC4E_BB = TIM1_OCInitStruct->TIM1_OutputState;
    536          
    537            /* Set the Output Polarity */
    538            *(vu32 *) CCER_CC4P_BB = TIM1_OCInitStruct->TIM1_OCPolarity;
    539          
    540            /* Set the Output Idle state */
    541            *(vu32 *) CR2_OIS4_BB = TIM1_OCInitStruct->TIM1_OCIdleState;
    542          
    543            /* Set the Pulse value */
    544            TIM1->CCR4 = TIM1_OCInitStruct->TIM1_Pulse;
    545          }
    546          
    547          /*******************************************************************************
    548          * Function Name  : TIM1_BDTRConfig
    549          * Description    : Configures the: Break feature, dead time, Lock level, the OSSI,
    550          *                  the OSSR State and the AOE(automatic output enable).
    551          * Input          : - TIM1_BDTRInitStruct: pointer to a TIM1_BDTRInitTypeDef
    552          *                    structure that contains the BDTR Register configuration
    553          *                    information for the TIM1 peripheral.
    554          * Output         : None
    555          * Return         : None
    556          *******************************************************************************/
    557          void TIM1_BDTRConfig(TIM1_BDTRInitTypeDef *TIM1_BDTRInitStruct)
    558          {
    559            u16 tmpbdtr = 0;
    560          
    561            /* Check the parameters */
    562            assert(IS_TIM1_OSSR_STATE(TIM1_BDTRInitStruct->TIM1_OSSRState));
    563            assert(IS_TIM1_OSSI_STATE(TIM1_BDTRInitStruct->TIM1_OSSIState));
    564            assert(IS_TIM1_LOCK_LEVEL(TIM1_BDTRInitStruct->TIM1_LOCKLevel));
    565            assert(IS_TIM1_BREAK_STATE(TIM1_BDTRInitStruct->TIM1_Break));
    566            assert(IS_TIM1_BREAK_POLARITY(TIM1_BDTRInitStruct->TIM1_BreakPolarity));
    567            assert(IS_TIM1_AUTOMATIC_OUTPUT_STATE(TIM1_BDTRInitStruct->TIM1_AutomaticOutput));
    568          
    569            tmpbdtr = TIM1->BDTR;
    570          
    571            /* Set the Lock level, the Break enable Bit and the Ploarity, the OSSR State,
    572               the OSSI State, the dead time value and the Automatic Output Enable Bit */
    573          
    574            tmpbdtr = (u32)TIM1_BDTRInitStruct->TIM1_OSSRState | TIM1_BDTRInitStruct->TIM1_OSSIState |
    575                       TIM1_BDTRInitStruct->TIM1_LOCKLevel | TIM1_BDTRInitStruct->TIM1_DeadTime |
    576          			 TIM1_BDTRInitStruct->TIM1_Break | TIM1_BDTRInitStruct->TIM1_BreakPolarity |
    577                       TIM1_BDTRInitStruct->TIM1_AutomaticOutput;
    578          
    579            TIM1->BDTR = tmpbdtr;
    580          }
    581          
    582          /*******************************************************************************
    583          * Function Name  : TIM1_ICInit
    584          * Description    : Initializes the TIM1 peripheral according to the specified
    585          *                  parameters in the TIM1_ICInitStruct.
    586          * Input          : - TIM1_ICInitStruct: pointer to a TIM1_ICInitTypeDef structure
    587          *                    that contains the configuration information for the specified
    588          *                    TIM1 peripheral.
    589          * Output         : None
    590          * Return         : None
    591          *******************************************************************************/
    592          void TIM1_ICInit(TIM1_ICInitTypeDef* TIM1_ICInitStruct)
    593          {
    594            /* Check the parameters */
    595            assert(IS_TIM1_CHANNEL(TIM1_ICInitStruct->TIM1_Channel));
    596            assert(IS_TIM1_IC_POLARITY(TIM1_ICInitStruct->TIM1_ICPolarity));
    597            assert(IS_TIM1_IC_SELECTION(TIM1_ICInitStruct->TIM1_ICSelection));
    598            assert(IS_TIM1_IC_PRESCALER(TIM1_ICInitStruct->TIM1_ICPrescaler));
    599            assert(IS_TIM1_IC_FILTER(TIM1_ICInitStruct->TIM1_ICFilter));
    600          
    601            if (TIM1_ICInitStruct->TIM1_Channel == TIM1_Channel_1)
    602            {
    603              /* TI1 Configuration */
    604              TI1_Config(TIM1_ICInitStruct->TIM1_ICPolarity,
    605                         TIM1_ICInitStruct->TIM1_ICSelection,
    606                         TIM1_ICInitStruct->TIM1_ICFilter);
    607          
    608              /* Set the Input Capture Prescaler value */
    609              TIM1_SetIC1Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    610            }
    611            else if (TIM1_ICInitStruct->TIM1_Channel == TIM1_Channel_2)
    612            {
    613              /* TI2 Configuration */
    614              TI2_Config(TIM1_ICInitStruct->TIM1_ICPolarity,
    615                         TIM1_ICInitStruct->TIM1_ICSelection,
    616                         TIM1_ICInitStruct->TIM1_ICFilter);
    617          
    618              /* Set the Input Capture Prescaler value */
    619              TIM1_SetIC2Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    620            }
    621            else if (TIM1_ICInitStruct->TIM1_Channel == TIM1_Channel_3)
    622            {
    623              /* TI3 Configuration */
    624              TI3_Config(TIM1_ICInitStruct->TIM1_ICPolarity,
    625                         TIM1_ICInitStruct->TIM1_ICSelection,
    626                         TIM1_ICInitStruct->TIM1_ICFilter);
    627          
    628              /* Set the Input Capture Prescaler value */
    629              TIM1_SetIC3Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    630            }
    631            else
    632            {
    633              /* TI4 Configuration */
    634              TI4_Config(TIM1_ICInitStruct->TIM1_ICPolarity,
    635                         TIM1_ICInitStruct->TIM1_ICSelection,
    636                         TIM1_ICInitStruct->TIM1_ICFilter);
    637          
    638              /* Set the Input Capture Prescaler value */
    639              TIM1_SetIC4Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    640            }
    641          }
    642          
    643          /*******************************************************************************
    644          * Function Name  : TIM1_PWMIConfig
    645          * Description    : Configures the TIM1 peripheral in PWM Input Mode according 
    646          *                  to the specified parameters in the TIM1_ICInitStruct.
    647          * Input          : - TIM1_ICInitStruct: pointer to a TIM1_ICInitTypeDef structure
    648          *                    that contains the configuration information for the specified
    649          *                    TIM1 peripheral.
    650          * Output         : None
    651          * Return         : None
    652          *******************************************************************************/
    653          void TIM1_PWMIConfig(TIM1_ICInitTypeDef* TIM1_ICInitStruct)
    654          {
    655            u8 ICPolarity = TIM1_ICPolarity_Rising;
    656            u8 ICSelection = TIM1_ICSelection_DirectTI;
    657          
    658            /* Check the parameters */
    659            assert(IS_TIM1_PWMI_CHANNEL(TIM1_ICInitStruct->TIM1_Channel));
    660            assert(IS_TIM1_IC_POLARITY(TIM1_ICInitStruct->TIM1_ICPolarity));
    661            assert(IS_TIM1_IC_SELECTION(TIM1_ICInitStruct->TIM1_ICSelection));
    662            assert(IS_TIM1_IC_PRESCALER(TIM1_ICInitStruct->TIM1_ICPrescaler));
    663          
    664            /* Select the Opposite Input Polarity */
    665            if (TIM1_ICInitStruct->TIM1_ICPolarity == TIM1_ICPolarity_Rising)
    666            {
    667              ICPolarity = TIM1_ICPolarity_Falling;
    668            }
    669            else
    670            {
    671              ICPolarity = TIM1_ICPolarity_Rising;
    672            }
    673          
    674            /* Select the Opposite Input */
    675            if (TIM1_ICInitStruct->TIM1_ICSelection == TIM1_ICSelection_DirectTI)
    676            {
    677              ICSelection = TIM1_ICSelection_IndirectTI;
    678            }
    679            else
    680            {
    681              ICSelection = TIM1_ICSelection_DirectTI;
    682            }
    683          
    684            if (TIM1_ICInitStruct->TIM1_Channel == TIM1_Channel_1)
    685            {
    686              /* TI1 Configuration */
    687              TI1_Config(TIM1_ICInitStruct->TIM1_ICPolarity, TIM1_ICInitStruct->TIM1_ICSelection,
    688                         TIM1_ICInitStruct->TIM1_ICFilter);
    689          
    690              /* Set the Input Capture Prescaler value */
    691              TIM1_SetIC1Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    692          
    693              /* TI2 Configuration */
    694              TI2_Config(ICPolarity, ICSelection, TIM1_ICInitStruct->TIM1_ICFilter);
    695          
    696              /* Set the Input Capture Prescaler value */
    697              TIM1_SetIC2Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    698            }
    699            else
    700            {	 
    701              /* TI2 Configuration */
    702              TI2_Config(TIM1_ICInitStruct->TIM1_ICPolarity, TIM1_ICInitStruct->TIM1_ICSelection,
    703                         TIM1_ICInitStruct->TIM1_ICFilter);
    704          
    705              /* Set the Input Capture Prescaler value */
    706              TIM1_SetIC2Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    707          
    708              /* TI1 Configuration */
    709              TI1_Config(ICPolarity, ICSelection, TIM1_ICInitStruct->TIM1_ICFilter);
    710          
    711              /* Set the Input Capture Prescaler value */
    712              TIM1_SetIC1Prescaler(TIM1_ICInitStruct->TIM1_ICPrescaler);
    713            }
    714          }
    715          /*******************************************************************************
    716          * Function Name  : TIM1_OCStructInit
    717          * Description    : Fills each TIM1_OCInitStruct member with its default value.
    718          * Input          : - TIM1_OCInitStruct : pointer to a TIM1_OCInitTypeDef structure
    719          *                    which will be initialized.
    720          * Output         : None
    721          * Return         : None
    722          *******************************************************************************/
    723          void TIM1_OCStructInit(TIM1_OCInitTypeDef* TIM1_OCInitStruct)
    724          {
    725            /* Set the default configuration */
    726            TIM1_OCInitStruct->TIM1_OCMode = TIM1_OCMode_Timing;
    727            TIM1_OCInitStruct->TIM1_OutputState = TIM1_OutputState_Disable;
    728            TIM1_OCInitStruct->TIM1_OutputNState = TIM1_OutputNState_Disable;
    729            TIM1_OCInitStruct->TIM1_Pulse = TIM1_Pulse_Reset_Mask;
    730            TIM1_OCInitStruct->TIM1_OCPolarity = TIM1_OCPolarity_High;
    731            TIM1_OCInitStruct->TIM1_OCNPolarity = TIM1_OCPolarity_High;
    732            TIM1_OCInitStruct->TIM1_OCIdleState = TIM1_OCIdleState_Reset;
    733            TIM1_OCInitStruct->TIM1_OCNIdleState = TIM1_OCNIdleState_Reset;
    734          }
    735          
    736          /*******************************************************************************
    737          * Function Name  : TIM1_ICStructInit
    738          * Description    : Fills each TIM1_ICInitStruct member with its default value.
    739          * Input          : - TIM1_ICInitStruct : pointer to a TIM1_ICInitTypeDef structure
    740          *                    which will be initialized.
    741          * Output         : None
    742          * Return         : None
    743          *******************************************************************************/
    744          void TIM1_ICStructInit(TIM1_ICInitTypeDef* TIM1_ICInitStruct)
    745          {
    746            /* Set the default configuration */
    747            TIM1_ICInitStruct->TIM1_Channel = TIM1_Channel_1;
    748            TIM1_ICInitStruct->TIM1_ICSelection = TIM1_ICSelection_DirectTI;
    749            TIM1_ICInitStruct->TIM1_ICPolarity = TIM1_ICPolarity_Rising;
    750            TIM1_ICInitStruct->TIM1_ICPrescaler = TIM1_ICPSC_DIV1;
    751            TIM1_ICInitStruct->TIM1_ICFilter = TIM1_ICFilter_Mask;
    752          }
    753          
    754          /*******************************************************************************
    755          * Function Name  : TIM1_TimeBaseStructInit
    756          * Description    : Fills each TIM1_TimeBaseInitStruct member with its default value.
    757          * Input          : - TIM1_TimeBaseInitStruct : pointer to a TIM1_TimeBaseInitTypeDef
    758          *                    structure which will be initialized.
    759          * Output         : None
    760          * Return         : None
    761          *******************************************************************************/
    762          void TIM1_TimeBaseStructInit(TIM1_TimeBaseInitTypeDef* TIM1_TimeBaseInitStruct)
    763          {
    764            /* Set the default configuration */
    765            TIM1_TimeBaseInitStruct->TIM1_Period = TIM1_Period_Reset_Mask;
    766            TIM1_TimeBaseInitStruct->TIM1_Prescaler = TIM1_Prescaler_Reset_Mask;
    767            TIM1_TimeBaseInitStruct->TIM1_ClockDivision = TIM1_CKD_DIV1;
    768            TIM1_TimeBaseInitStruct->TIM1_CounterMode = TIM1_CounterMode_Up;
    769            TIM1_TimeBaseInitStruct->TIM1_RepetitionCounter = TIM1_RepetitionCounter_Reset_Mask;
    770          }
    771          
    772          /*******************************************************************************
    773          * Function Name  : TIM1_BDTRStructInit
    774          * Description    : Fills each TIM1_BDTRInitStruct member with its default value.
    775          * Input          : - TIM1_BDTRInitStruct : pointer to a TIM1_BDTRInitTypeDef
    776          *                    structure which will be initialized.
    777          * Output         : None
    778          * Return         : None
    779          *******************************************************************************/
    780          void TIM1_BDTRStructInit(TIM1_BDTRInitTypeDef* TIM1_BDTRInitStruct)
    781          {
    782            /* Set the default configuration */
    783            TIM1_BDTRInitStruct->TIM1_OSSRState = TIM1_OSSRState_Disable;
    784            TIM1_BDTRInitStruct->TIM1_OSSIState = TIM1_OSSIState_Disable;
    785            TIM1_BDTRInitStruct->TIM1_LOCKLevel = TIM1_LOCKLevel_OFF;
    786            TIM1_BDTRInitStruct->TIM1_DeadTime = TIM1_DeadTime_Reset_Mask;
    787            TIM1_BDTRInitStruct->TIM1_Break = TIM1_Break_Disable;
    788            TIM1_BDTRInitStruct->TIM1_BreakPolarity = TIM1_BreakPolarity_Low;
    789            TIM1_BDTRInitStruct->TIM1_AutomaticOutput = TIM1_AutomaticOutput_Disable;
    790          }
    791          
    792          /*******************************************************************************
    793          * Function Name  : TIM1_Cmd
    794          * Description    : Enables or disables the TIM1 peripheral.
    795          * Input          : - Newstate: new state of the TIM1 peripheral.
    796          *                    This parameter can be: ENABLE or DISABLE.
    797          * Output         : None
    798          * Return         : None
    799          *******************************************************************************/
    800          void TIM1_Cmd(FunctionalState NewState)
    801          {
    802            /* Check the parameters */
    803            assert(IS_FUNCTIONAL_STATE(NewState));
    804          
    805            /* set or Reset the CEN Bit */
    806            *(vu32 *) CR1_CEN_BB = (u16)NewState;
    807          }
    808          
    809          /*******************************************************************************
    810          * Function Name  : TIM1_CtrlPWMOutputs
    811          * Description    : Enables or disables the TIM1 peripheral Main Outputs.
    812          * Input          : - Newstate: new state of the TIM1 peripheral Main Outputs.
    813          *                    This parameter can be: ENABLE or DISABLE.
    814          * Output         : None
    815          * Return         : None
    816          *******************************************************************************/
    817          void TIM1_CtrlPWMOutputs(FunctionalState Newstate)
    818          {
    819            /* Check the parameters */
    820            assert(IS_FUNCTIONAL_STATE(Newstate));
    821          
    822            /* Set or Reset the MOE Bit */
    823            *(vu32 *) BDTR_MOE_BB = (u16)Newstate;
    824          }
    825          
    826          /*******************************************************************************
    827          * Function Name  : TIM1_ITConfig
    828          * Description    : Enables or disables the specified TIM1 interrupts.
    829          * Input          : - TIM1_IT: specifies the TIM1 interrupts sources to be enabled
    830          *                    or disabled.
    831          *                    This parameter can be any combination of the following values:
    832          *                       - TIM1_IT_Update: TIM1 update Interrupt source
    833          *                       - TIM1_IT_CC1: TIM1 Capture Compare 1 Interrupt source
    834          *                       - TIM1_IT_CC2: TIM1 Capture Compare 2 Interrupt source
    835          *                       - TIM1_IT_CC3: TIM1 Capture Compare 3 Interrupt source
    836          *                       - TIM1_IT_CC4: TIM1 Capture Compare 4 Interrupt source
    837          *                       - TIM1_IT_CCUpdate: TIM1 Capture Compare Update Interrupt
    838          *                         source
    839          *                       - TIM1_IT_Trigger: TIM1 Trigger Interrupt source
    840          *                       - TIM1_IT_Break: TIM1 Break Interrupt source
    841          *                  - Newstate: new state of the TIM1 interrupts.
    842          *                    This parameter can be: ENABLE or DISABLE.
    843          * Output         : None
    844          * Return         : None
    845          *******************************************************************************/
    846          void TIM1_ITConfig(u16 TIM1_IT, FunctionalState NewState)
    847          {
    848            /* Check the parameters */
    849            assert(IS_TIM1_IT(TIM1_IT));
    850            assert(IS_FUNCTIONAL_STATE(NewState));
    851          
    852            if (NewState == ENABLE)
    853            {
    854              /* Enable the Interrupt sources */
    855              TIM1->DIER |= TIM1_IT;
    856            }
    857            else
    858            {
    859              /* Disable the Interrupt sources */
    860              TIM1->DIER &= (u16)~TIM1_IT;
    861            }
    862          }
    863          
    864          /*******************************************************************************
    865          * Function Name  : TIM1_DMAConfig
    866          * Description    : Configures the TIM1s DMA interface.
    867          * Input          : - TIM1_DMABase: DMA Base address.
    868          *                    This parameter can be one of the following values:
    869          *                       - TIM1_DMABase_CR1, TIM1_DMABase_CR2, TIM1_DMABase_SMCR,
    870          *                         TIM1_DMABase_DIER, TIM1_DMABase_SR, TIM1_DMABase_EGR,
    871          *                         TIM1_DMABase_CCMR1, TIM1_DMABase_CCMR2, TIM1_DMABase_CCER,
    872          *                         TIM1_DMABase_CNT, TIM1_DMABase_PSC, TIM1_DMABase_ARR,
    873          *                         TIM1_DMABase_RCR, TIM1_DMABase_CCR1, TIM1_DMABase_CCR2,
    874          *                         TIM1_DMABase_CCR3, TIM1_DMABase_CCR4, TIM1_DMABase_BDTR,
    875          *                         TIM1_DMABase_DCR.
    876          *                   - TIM1_DMABurstLength: DMA Burst length.
    877          *                     This parameter can be one value between:
    878          *                     TIM1_DMABurstLength_1Byte and TIM1_DMABurstLength_18Bytes.
    879          * Output         : None
    880          * Return         : None
    881          *******************************************************************************/
    882          void TIM1_DMAConfig(u16 TIM1_DMABase, u16 TIM1_DMABurstLength)
    883          {
    884            u32 tmpdcr = 0;
    885          
    886            /* Check the parameters */
    887            assert(IS_TIM1_DMA_BASE(TIM1_DMABase));
    888            assert(IS_TIM1_DMA_LENGTH(TIM1_DMABurstLength));
    889          
    890            tmpdcr = TIM1->DCR;
    891          
    892            /* Reset the DBA and the DBL Bits */
    893            tmpdcr &= DCR_DMA_Mask;
    894          
    895            /* Set the DMA Base and the DMA Burst Length */
    896            tmpdcr |= TIM1_DMABase | TIM1_DMABurstLength;
    897          
    898            TIM1->DCR = (u16)tmpdcr;
    899          }
    900          
    901          /*******************************************************************************
    902          * Function Name  : TIM1_DMACmd
    903          * Description    : Enables or disables the TIM1s DMA Requests.
    904          * Input          : - TIM1_DMASources: specifies the DMA Request sources.
    905          *                    This parameter can be any combination of the following values:
    906          *                       - TIM1_DMA_Update: TIM1 update Interrupt source
    907          *                       - TIM1_DMA_CC1: TIM1 Capture Compare 1 DMA source
    908          *                       - TIM1_DMA_CC2: TIM1 Capture Compare 2 DMA source
    909          *                       - TIM1_DMA_CC3: TIM1 Capture Compare 3 DMA source
    910          *                       - TIM1_DMA_CC4: TIM1 Capture Compare 4 DMA source
    911          *                       - TIM1_DMA_COM: TIM1 Capture Compare Update DMA
    912          *                         source
    913          *                       - TIM1_DMA_Trigger: TIM1 Trigger DMA source
    914          *                  - Newstate: new state of the DMA Request sources.
    915          *                    This parameter can be: ENABLE or DISABLE.
    916          * Output         : None
    917          * Return         : None
    918          *******************************************************************************/
    919          void TIM1_DMACmd(u16 TIM1_DMASource, FunctionalState Newstate)
    920          {
    921            u32 tmpdier = 0;
    922          
    923            /* Check the parameters */
    924            assert(IS_TIM1_DMA_SOURCE(TIM1_DMASource));
    925            assert(IS_FUNCTIONAL_STATE(Newstate));
    926          
    927            tmpdier = TIM1->DIER;
    928          
    929            if (Newstate == ENABLE)
    930            {
    931              /* Enable the DMA sources */
    932              tmpdier |= TIM1_DMASource;
    933            }
    934            else
    935            {
    936              /* Disable the DMA sources */
    937              tmpdier &= (u16)~TIM1_DMASource;
    938            }
    939            TIM1->DIER = (u16)tmpdier;
    940          }
    941          
    942          /*******************************************************************************
    943          * Function Name  : TIM1_InternalClockConfig
    944          * Description    : Configures the TIM1 interrnal Clock
    945          * Input          : None
    946          * Output         : None
    947          * Return         : None
    948          *******************************************************************************/
    949          void TIM1_InternalClockConfig(void)
    950          {
    951            /* Disable slave mode to clock the prescaler directly with the internal clock */
    952            TIM1->SMCR &=  SMCR_SMS_Mask;
    953          }
    954          /*******************************************************************************
    955          * Function Name  : TIM1_ETRClockMode1Config
    956          * Description    : Configures the TIM1 External clock Mode1
    957          * Input          : - TIM1_ExtTRGPrescaler: The external Trigger Prescaler.
    958          *                    It can be one of the following values:
    959          *                       - TIM1_ExtTRGPSC_OFF
    960          *                       - TIM1_ExtTRGPSC_DIV2
    961          *                       - TIM1_ExtTRGPSC_DIV4
    962          *                       - TIM1_ExtTRGPSC_DIV8.
    963          *                  - TIM1_ExtTRGPolarity: The external Trigger Polarity.
    964          *                    It can be one of the following values:
    965          *                       - TIM1_ExtTRGPolarity_Inverted
    966          *                       - TIM1_ExtTRGPolarity_NonInverted
    967          *                  - ExtTRGFilter: External Trigger Filter.
    968          *                    This parameter must be a value between 0x00 and 0x0F
    969          * Output         : None
    970          * Return         : None
    971          *******************************************************************************/
    972          void TIM1_ETRClockMode1Config(u16 TIM1_ExtTRGPrescaler, u16 TIM1_ExtTRGPolarity,
    973                                       u16 ExtTRGFilter)
    974          {
    975            /* Check the parameters */
    976            assert(IS_TIM1_EXT_PRESCALER(TIM1_ExtTRGPrescaler));
    977            assert(IS_TIM1_EXT_POLARITY(TIM1_ExtTRGPolarity));
    978          
    979            /* Configure the ETR Clock source */
    980            TIM1_ETRConfig(TIM1_ExtTRGPrescaler, TIM1_ExtTRGPolarity, ExtTRGFilter);
    981          
    982            /* Select the External clock mode1 */
    983            TIM1->SMCR &= SMCR_SMS_Mask;
    984            TIM1->SMCR |= TIM1_SlaveMode_External1;
    985            
    986            /* Select the Trigger selection : ETRF */
    987            TIM1->SMCR &= SMCR_TS_Mask;
    988            TIM1->SMCR |= TIM1_TS_ETRF;
    989          }
    990          
    991          /*******************************************************************************
    992          * Function Name  : TIM1_ETRClockMode2Config
    993          * Description    : Configures the TIM1 External clock Mode2
    994          * Input          : - TIM1_ExtTRGPrescaler: The external Trigger Prescaler.
    995          *                    It can be one of the following values:
    996          *                       - TIM1_ExtTRGPSC_OFF
    997          *                       - TIM1_ExtTRGPSC_DIV2
    998          *                       - TIM1_ExtTRGPSC_DIV4
    999          *                       - TIM1_ExtTRGPSC_DIV8
   1000          *                  - TIM1_ExtTRGPolarity: The external Trigger Polarity.
   1001          *                    It can be one of the following values:
   1002          *                       - TIM1_ExtTRGPolarity_Inverted
   1003          *                       - TIM1_ExtTRGPolarity_NonInverted
   1004          *                  - ExtTRGFilter: External Trigger Filter.
   1005          *                    This parameter must be a value between 0x00 and 0x0F
   1006          * Output         : None
   1007          * Return         : None
   1008          *******************************************************************************/
   1009          void TIM1_ETRClockMode2Config(u16 TIM1_ExtTRGPrescaler, u16 TIM1_ExtTRGPolarity,
   1010                                       u16 ExtTRGFilter)
   1011          {
   1012            /* Check the parameters */
   1013            assert(IS_TIM1_EXT_PRESCALER(TIM1_ExtTRGPrescaler));
   1014            assert(IS_TIM1_EXT_POLARITY(TIM1_ExtTRGPolarity));
   1015          
   1016            /* Configure the ETR Clock source */
   1017            TIM1_ETRConfig(TIM1_ExtTRGPrescaler, TIM1_ExtTRGPolarity, ExtTRGFilter);
   1018          
   1019            /* Enable the External clock mode2 */
   1020            *(vu32 *) SMCR_ECE_BB = SMCR_ECE_Set;
   1021          }
   1022          
   1023          /*******************************************************************************
   1024          * Function Name  : TIM1_ETRConfig
   1025          * Description    : Configures the TIM1 External Trigger (ETR).
   1026          * Input          : - TIM1_ExtTRGPrescaler: The external Trigger Prescaler.
   1027          *                    This parameter can be one of the following values:
   1028          *                       - TIM1_ExtTRGPSC_OFF
   1029          *                       - TIM1_ExtTRGPSC_DIV2
   1030          *                       - TIM1_ExtTRGPSC_DIV4
   1031          *                       - TIM1_ExtTRGPSC_DIV8
   1032          *                  - TIM1_ExtTRGPolarity: The external Trigger Polarity.
   1033          *                    This parameter can be one of the following values:
   1034          *                       - TIM1_ExtTRGPolarity_Inverted
   1035          *                       - TIM1_ExtTRGPolarity_NonInverted
   1036          *                  - ExtTRGFilter: External Trigger Filter.
   1037          *                    This parameter must be a value between 0x00 and 0x0F.
   1038          * Output         : None
   1039          * Return         : None
   1040          *******************************************************************************/
   1041          void TIM1_ETRConfig(u16 TIM1_ExtTRGPrescaler, u16 TIM1_ExtTRGPolarity,
   1042                              u16 ExtTRGFilter)
   1043          {
   1044            u32 tmpsmcr = 0;
   1045          
   1046            tmpsmcr = TIM1->SMCR;
   1047          
   1048            /* Set the Prescaler, the Filter value and the Polarity */
   1049            tmpsmcr &= SMCR_ETR_Mask;
   1050            tmpsmcr |= TIM1_ExtTRGPrescaler | TIM1_ExtTRGPolarity | (u16)((u16)ExtTRGFilter << 8);
   1051          
   1052            TIM1->SMCR = (u16)tmpsmcr;
   1053          }
   1054          
   1055          /*******************************************************************************
   1056          * Function Name  : TIM1_ITRxExternalClockConfig
   1057          * Description    : Configures the TIM1 Internal Trigger as External Clock
   1058          * Input          : - TIM1_ITRSource: Internal Trigger source.
   1059          *                    This parameter can be one of the following values:
   1060          *                       - TIM1_TS_ITR0: Internal Trigger 0
   1061          *                       - TIM1_TS_ITR1: Internal Trigger 1
   1062          *                       - TIM1_TS_ITR2: Internal Trigger 2
   1063          *                       - TIM1_TS_ITR3: Internal Trigger 3
   1064          * Output         : None
   1065          * Return         : None
   1066          *******************************************************************************/
   1067          void TIM1_ITRxExternalClockConfig(u16 TIM1_InputTriggerSource)
   1068          {
   1069            /* Check the parameters */
   1070            assert(IS_TIM1_INTERNAL_TRIGGER_SELECTION(TIM1_InputTriggerSource));
   1071            
   1072            /* Select the Internal Trigger */
   1073            TIM1_SelectInputTrigger(TIM1_InputTriggerSource);
   1074          
   1075            /* Select the External clock mode1 */
   1076            TIM1->SMCR |= TIM1_SlaveMode_External1;
   1077          }
   1078          
   1079          /*******************************************************************************
   1080          * Function Name  : TIM1_TIxExternalClockConfig
   1081          * Description    : Configures the TIM1 Trigger as External Clock
   1082          * Input          : - TIM1_TIxExternalCLKSource: Trigger source.
   1083          *                    This parameter can be one of the following values:
   1084          *                       - TIM1_TS_TI1F_ED: TI1 Edge Detector
   1085          *                       - TIM1_TS_TI1FP1: Filtered TIM1 Input 1
   1086          *                       - TIM1_TS_TI2FP2: Filtered TIM1 Input 2
   1087          *                  - TIM1_ICPolarity: specifies the TIx Polarity.
   1088          *                    This parameter can be:
   1089          *                       - TIM1_ICPolarity_Rising
   1090          *                       - TIM1_ICPolarity_Falling
   1091          *                   - ICFilter : specifies the filter value.
   1092          *                     This parameter must be a value between 0x0 and 0xF.
   1093          * Output         : None
   1094          * Return         : None
   1095          *******************************************************************************/
   1096          void TIM1_TIxExternalClockConfig(u16 TIM1_TIxExternalCLKSource,
   1097                                          u16 TIM1_ICPolarity, u8 ICFilter)
   1098          {
   1099            /* Check the parameters */
   1100            assert(IS_TIM1_TIX_TRIGGER_SELECTION(TIM1_TIxExternalCLKSource));
   1101            assert(IS_TIM1_IC_POLARITY(TIM1_ICPolarity));
   1102            assert(IS_TIM1_IC_FILTER(ICFilter));
   1103          
   1104            /* Configure the TIM1 Input Clock Source */
   1105            if (TIM1_TIxExternalCLKSource == TIM1_TIxExternalCLK1Source_TI2)
   1106            {
   1107              TI2_Config(TIM1_ICPolarity, TIM1_ICSelection_DirectTI, ICFilter);
   1108            }
   1109            else
   1110            {
   1111              TI1_Config(TIM1_ICPolarity, TIM1_ICSelection_DirectTI, ICFilter);
   1112            }
   1113          
   1114            /* Select the Trigger source */
   1115            TIM1_SelectInputTrigger(TIM1_TIxExternalCLKSource);
   1116          
   1117            /* Select the External clock mode1 */
   1118            TIM1->SMCR |= TIM1_SlaveMode_External1;
   1119          }
   1120          /*******************************************************************************
   1121          * Function Name  : TIM1_SelectInputTrigger
   1122          * Description    : Selects the TIM1 Input Trigger source
   1123          * Input          : - TIM1_InputTriggerSource: The Trigger source.
   1124          *                    This parameter can be one of the following values:
   1125          *                       - TIM1_TS_ITR0: Internal Trigger 0
   1126          *                       - TIM1_TS_ITR1: Internal Trigger 1
   1127          *                       - TIM1_TS_ITR2: Internal Trigger 2
   1128          *                       - TIM1_TS_ITR3: Internal Trigger 3
   1129          *                       - TIM1_TS_TI1F_ED: TI1 Edge Detector
   1130          *                       - TIM1_TS_TI1FP1: Filtered Timer Input 1
   1131          *                       - TIM1_TS_TI2FP2: Filtered Timer Input 2
   1132          *                       - TIM1_TS_ETRF: External Trigger input
   1133          * Output         : None
   1134          * Return         : None
   1135          *******************************************************************************/
   1136          void TIM1_SelectInputTrigger(u16 TIM1_InputTriggerSource)
   1137          {
   1138            u32 tmpsmcr = 0;
   1139          
   1140            /* Check the parameters */
   1141            assert(IS_TIM1_TRIGGER_SELECTION(TIM1_InputTriggerSource));
   1142          
   1143            tmpsmcr = TIM1->SMCR;
   1144          
   1145            /* Select the Tgigger Source */
   1146            tmpsmcr &= SMCR_TS_Mask;
   1147            tmpsmcr |= TIM1_InputTriggerSource;
   1148          
   1149            TIM1->SMCR = (u16)tmpsmcr;
   1150          }
   1151          
   1152          /*******************************************************************************
   1153          * Function Name  : TIM1_UpdateDisableConfig
   1154          * Description    : Enables or Disables the TIM1 Update event.
   1155          * Input          : - Newstate: new state of the TIM1 peripheral Preload register
   1156          *                    This parameter can be: ENABLE or DISABLE.
   1157          * Output         : None
   1158          * Return         : None
   1159          *******************************************************************************/
   1160          void TIM1_UpdateDisableConfig(FunctionalState Newstate)
   1161          {
   1162            /* Check the parameters */
   1163            assert(IS_FUNCTIONAL_STATE(Newstate));
   1164          
   1165            /* Set or Reset the UDIS Bit */
   1166            *(vu32 *) CR1_UDIS_BB = (u16)Newstate;
   1167          }
   1168          
   1169          /*******************************************************************************
   1170          * Function Name  : TIM1_UpdateRequestConfig
   1171          * Description    : Selects the TIM1 Update Request Interrupt source.
   1172          * Input          : - TIM1_UpdateSource: specifies the Update source.
   1173          *                    This parameter can be one of the following values:
   1174          *                       - TIM1_UpdateSource_Regular
   1175          *                       - TIM1_UpdateSource_Global
   1176          * Output         : None
   1177          * Return         : None
   1178          *******************************************************************************/
   1179          void TIM1_UpdateRequestConfig(u8 TIM1_UpdateSource)
   1180          {
   1181            /* Check the parameters */
   1182            assert(IS_TIM1_UPDATE_SOURCE(TIM1_UpdateSource));
   1183          
   1184            /* Set or Reset the URS Bit */
   1185            *(vu32 *) CR1_URS_BB = TIM1_UpdateSource;
   1186          }
   1187          
   1188          /*******************************************************************************
   1189          * Function Name  : TIM1_SelectHallSensor
   1190          * Description    : Enables or disables the TIM1s Hall sensor interface.
   1191          * Input          : - Newstate: new state of the TIM1 Hall sensor interface
   1192          * Output         : None
   1193          * Return         : None
   1194          *******************************************************************************/
   1195          void TIM1_SelectHallSensor(FunctionalState Newstate)
   1196          {
   1197            /* Check the parameters */
   1198            assert(IS_FUNCTIONAL_STATE(Newstate));
   1199          
   1200            /* Set or Reset the TI1S Bit */
   1201            *(vu32 *) CR2_TI1S_BB = (u16)Newstate;
   1202          }
   1203          
   1204          /*******************************************************************************
   1205          * Function Name  : TIM1_SelectOPM
   1206          * Description    : Enables or disables the TIM1s One Pulse Mode.
   1207          * Input          : - TIM1_OPMode: specifies the OPM Mode to be used.
   1208          *                    This parameter can be one of the following values:
   1209          *                    - TIM1_OPMode_Single
   1210          *                    - TIM1_OPMode_Repetitive
   1211          * Output         : None
   1212          * Return         : None
   1213          *******************************************************************************/
   1214          void TIM1_SelectOnePulseMode(u16 TIM1_OPMode)
   1215          {
   1216            /* Check the parameters */
   1217            assert(IS_TIM1_OPM_MODE(TIM1_OPMode));
   1218          
   1219            /* Set or Reset the OPM Bit */
   1220            *(vu32 *) CR1_OPM_BB = TIM1_OPMode;
   1221          }
   1222          
   1223          /*******************************************************************************
   1224          * Function Name  : TIM1_SelectOutputTrigger
   1225          * Description    : Selects the TIM1 Trigger Output Mode.
   1226          * Input          : - TIM1_TRGOSource: specifies the Trigger Output source.
   1227          *                    This paramter can be one of the following values:
   1228          *                       - TIM1_TRGOSource_Reset
   1229          *                       - TIM1_TRGOSource_Enable
   1230          *                       - TIM1_TRGOSource_Update
   1231          *                       - TIM1_TRGOSource_OC1
   1232          *                       - TIM1_TRGOSource_OC1Ref
   1233          *                       - TIM1_TRGOSource_OC2Ref
   1234          *                       - TIM1_TRGOSource_OC3Ref
   1235          *                       - TIM1_TRGOSource_OC4Ref
   1236          * Output         : None
   1237          * Return         : None
   1238          *******************************************************************************/
   1239          void TIM1_SelectOutputTrigger(u16 TIM1_TRGOSource)
   1240          {
   1241            u32 tmpcr2 = 0;
   1242          
   1243            /* Check the parameters */
   1244            assert(IS_TIM1_TRGO_SOURCE(TIM1_TRGOSource));
   1245          
   1246            tmpcr2 = TIM1->CR2;
   1247          
   1248            /* Reset the MMS Bits */
   1249            tmpcr2 &= CR2_MMS_Mask;
   1250          
   1251            /* Select the TRGO source */
   1252            tmpcr2 |=  TIM1_TRGOSource;
   1253          
   1254            TIM1->CR2 = (u16)tmpcr2;
   1255          }
   1256          
   1257          /*******************************************************************************
   1258          * Function Name  : TIM1_SelectSlaveMode
   1259          * Description    : Selects the TIM1 Slave Mode.
   1260          * Input          : - TIM1_SlaveMode: specifies the TIM1 Slave Mode.
   1261          *                    This paramter can be one of the following values:
   1262          *                       - TIM1_SlaveMode_Reset
   1263          *                       - TIM1_SlaveMode_Gated
   1264          *                       - TIM1_SlaveMode_Trigger
   1265          *                       - TIM1_SlaveMode_External1
   1266          * Output         : None
   1267          * Return         : None
   1268          *******************************************************************************/
   1269          void TIM1_SelectSlaveMode(u16 TIM1_SlaveMode)
   1270          {
   1271            u32 tmpsmcr = 0;
   1272          
   1273            /* Check the parameters */
   1274            assert(IS_TIM1_SLAVE_MODE(TIM1_SlaveMode));
   1275          
   1276            tmpsmcr = TIM1->SMCR;
   1277          
   1278            /* Reset the SMS Bits */
   1279            tmpsmcr &= SMCR_SMS_Mask;
   1280          
   1281            /* Select the Slave Mode */
   1282            tmpsmcr |= TIM1_SlaveMode;
   1283          
   1284            TIM1->SMCR = (u16)tmpsmcr;
   1285          }
   1286          
   1287          /*******************************************************************************
   1288          * Function Name  : TIM1_SelectMasterSlaveMode
   1289          * Description    : Sets or Resets the TIM1 Master/Slave Mode.
   1290          * Input          : - TIM1_MasterSlaveMode: specifies the TIM1 Master Slave Mode.
   1291          *                    This paramter can be one of the following values:
   1292          *                       - TIM1_MasterSlaveMode_Enable: synchronization between
   1293          *                         the current timer and its slaves (through TRGO).
   1294          *                       - TIM1_MasterSlaveMode_Disable: No action
   1295          * Output         : None
   1296          * Return         : None
   1297          *******************************************************************************/
   1298          void TIM1_SelectMasterSlaveMode(u16 TIM1_MasterSlaveMode)
   1299          {
   1300            /* Check the parameters */
   1301            assert(IS_TIM1_MSM_STATE(TIM1_MasterSlaveMode));
   1302          
   1303            /* Set or Reset the MSM Bit */
   1304            *(vu32 *) SMCR_MSM_BB = TIM1_MasterSlaveMode;
   1305          }
   1306          
   1307          /*******************************************************************************
   1308          * Function Name  : TIM1_EncoderInterfaceConfig
   1309          * Description    : Configures the TIM1 Encoder Interface.
   1310          * Input          : - TIM1_EncoderMode: specifies the TIM1 Encoder Mode.
   1311          *                    This parameter can be one of the following values:
   1312          *                       - TIM1_EncoderMode_TI1: Counter counts on TI1FP1 edge
   1313          *                         depending on TI2FP2 level.
   1314          *                       - TIM1_EncoderMode_TI2: Counter counts on TI2FP2 edge
   1315          *                         depending on TI1FP1 level.
   1316          *                       - TIM1_EncoderMode_TI12: Counter counts on both TI1FP1 and
   1317          *                         TI2FP2 edges depending on the level of the other input.
   1318          *                  - TIM1_IC1Polarity: specifies the IC1 Polarity
   1319          *                    This parmeter can be one of the following values:
   1320          *                       - TIM1_ICPolarity_Falling
   1321          *                       - TIM1_ICPolarity_Rising
   1322          *                  - TIM1_IC2Polarity: specifies the IC2 Polarity
   1323          *                    This parmeter can be one of the following values:
   1324          *                       - TIM1_ICPolarity_Falling
   1325          *                       - TIM1_ICPolarity_Rising
   1326          * Output         : None
   1327          * Return         : None
   1328          *******************************************************************************/
   1329          void TIM1_EncoderInterfaceConfig(u16 TIM1_EncoderMode, u16 TIM1_IC1Polarity,
   1330                                          u16 TIM1_IC2Polarity)
   1331          {
   1332            u32 tmpsmcr = 0;
   1333            u32 tmpccmr1 = 0;
   1334          
   1335            /* Check the parameters */
   1336            assert(IS_TIM1_ENCODER_MODE(TIM1_EncoderMode));
   1337            assert(IS_TIM1_IC_POLARITY(TIM1_IC1Polarity));
   1338            assert(IS_TIM1_IC_POLARITY(TIM1_IC2Polarity));
   1339          
   1340            tmpsmcr = TIM1->SMCR;
   1341            tmpccmr1 = TIM1->CCMR1;
   1342          
   1343            /* Set the encoder Mode */
   1344            tmpsmcr &= SMCR_SMS_Mask;
   1345            tmpsmcr |= TIM1_EncoderMode;
   1346          
   1347            /* Select the Capture Compare 1 and the Capture Compare 2 as input */
   1348            tmpccmr1 &= CCMR_CC13S_Mask & CCMR_CC24S_Mask;
   1349            tmpccmr1 |= CCMR_TI13Direct_Set | CCMR_TI24Direct_Set;
   1350          
   1351            /* Set the TI1 and the TI2 Polarities */
   1352            *(vu32 *) CCER_CC1P_BB = TIM1_IC1Polarity;
   1353            *(vu32 *) CCER_CC2P_BB = TIM1_IC2Polarity;
   1354          
   1355            TIM1->SMCR = (u16)tmpsmcr;
   1356          
   1357            TIM1->CCMR1 = (u16)tmpccmr1;
   1358          }
   1359          
   1360          /*******************************************************************************
   1361          * Function Name  : TIM1_PrescalerConfig
   1362          * Description    : Configures the TIM1 Prescaler.
   1363          * Input          : - Prescaler: specifies the Prescaler Register value
   1364          *                  - TIM1_PSCReloadMode: specifies the TIM1 Prescaler Reload mode.
   1365          *                    This parmeter can be one of the following values:
   1366          *                       - TIM1_PSCReloadMode_Update: The Prescaler is loaded at
   1367          *                         the update event.
   1368          *                       - TIM1_PSCReloadMode_Immediate: The Prescaler is loaded
   1369          *                         immediatly.
   1370          * Output         : None
   1371          * Return         : None
   1372          *******************************************************************************/
   1373          void TIM1_PrescalerConfig(u16 Prescaler, u16 TIM1_PSCReloadMode)
   1374          {
   1375            /* Check the parameters */
   1376            assert(IS_TIM1_PRESCALER_RELOAD(TIM1_PSCReloadMode));
   1377          
   1378            /* Set the Prescaler value */
   1379            TIM1->PSC = Prescaler;
   1380          
   1381            /* Set or reset the UG Bit */
   1382            *(vu32 *) EGR_UG_BB = TIM1_PSCReloadMode;
   1383          }
   1384          /*******************************************************************************
   1385          * Function Name  : TIM1_CounterModeConfig
   1386          * Description    : Specifies the TIM1 Counter Mode to be used.
   1387          * Input          : - TIM1_CounterMode: specifies the Counter Mode to be used
   1388          *                    This parameter can be one of the following values:
   1389          *                       - TIM1_CounterMode_Up: TIM1 Up Counting Mode
   1390          *                       - TIM1_CounterMode_Down: TIM1 Down Counting Mode
   1391          *                       - TIM1_CounterMode_CenterAligned1: TIM1 Center Aligned Mode1
   1392          *                       - TIM1_CounterMode_CenterAligned2: TIM1 Center Aligned Mode2
   1393          *                       - TIM1_CounterMode_CenterAligned3: TIM1 Center Aligned Mode3
   1394          * Output         : None
   1395          * Return         : None
   1396          *******************************************************************************/
   1397          void TIM1_CounterModeConfig(u16 TIM1_CounterMode)
   1398          {
   1399            u32 tmpcr1 = 0;
   1400          
   1401            /* Check the parameters */
   1402            assert(IS_TIM1_COUNTER_MODE(TIM1_CounterMode));
   1403          
   1404            tmpcr1 = TIM1->CR1;
   1405          
   1406            /* Reset the CMS and DIR Bits */
   1407            tmpcr1 &= CR1_CounterMode_Mask;
   1408          
   1409            /* Set the Counter Mode */
   1410            tmpcr1 |= TIM1_CounterMode;
   1411          
   1412            TIM1->CR1 = (u16)tmpcr1;
   1413          }
   1414          
   1415          /*******************************************************************************
   1416          * Function Name  : TIM1_ForcedOC1Config
   1417          * Description    : Forces the TIM1 Channel1 output waveform to active or inactive 
   1418          *                  level.
   1419          * Input          : - TIM1_ForcedAction: specifies the forced Action to be set to
   1420          *                    the output waveform.
   1421          *                    This parameter can be one of the following values:
   1422          *                       - TIM1_ForcedAction_Active: Force active level on OC1REF
   1423          *                       - TIM1_ForcedAction_InActive: Force inactive level on
   1424          *                         OC1REF.
   1425          * Output         : None
   1426          * Return         : None
   1427          *******************************************************************************/
   1428          void TIM1_ForcedOC1Config(u16 TIM1_ForcedAction)
   1429          {
   1430            u32 tmpccmr1 = 0;
   1431          
   1432            /* Check the parameters */
   1433            assert(IS_TIM1_FORCED_ACTION(TIM1_ForcedAction));
   1434          
   1435            tmpccmr1 = TIM1->CCMR1;
   1436          
   1437            /* Reset the OCM Bits */
   1438            tmpccmr1 &= CCMR_OCM13_Mask;
   1439          
   1440            /* Configure The Forced output Mode */
   1441            tmpccmr1 |= TIM1_ForcedAction;
   1442          
   1443            TIM1->CCMR1 = (u16)tmpccmr1;
   1444          }
   1445          
   1446          /*******************************************************************************
   1447          * Function Name  : TIM1_ForcedOC2Config
   1448          * Description    : Forces the TIM1 Channel2 output waveform to active or inactive 
   1449          *                  level.
   1450          * Input          : - TIM1_ForcedAction: specifies the forced Action to be set to
   1451          *                    the output waveform.
   1452          *                    This parameter can be one of the following values:
   1453          *                       - TIM1_ForcedAction_Active: Force active level on OC2REF
   1454          *                       - TIM1_ForcedAction_InActive: Force inactive level on
   1455          *                         OC2REF.
   1456          * Output         : None
   1457          * Return         : None
   1458          *******************************************************************************/
   1459          void TIM1_ForcedOC2Config(u16 TIM1_ForcedAction)
   1460          {
   1461            u32 tmpccmr1 = 0;
   1462          
   1463            /* Check the parameters */
   1464            assert(IS_TIM1_FORCED_ACTION(TIM1_ForcedAction));
   1465          
   1466            tmpccmr1 = TIM1->CCMR1;
   1467          
   1468            /* Reset the OCM Bits */
   1469            tmpccmr1 &= CCMR_OCM24_Mask;
   1470          
   1471            /* Configure The Forced output Mode */
   1472            tmpccmr1 |= (u32)TIM1_ForcedAction << 8;
   1473          
   1474            TIM1->CCMR1 = (u16)tmpccmr1;
   1475          }
   1476          
   1477          /*******************************************************************************
   1478          * Function Name  : TIM1_ForcedOC3Config
   1479          * Description    : Forces the TIM1 Channel3 output waveform to active or inactive 
   1480          *                  level.
   1481          * Input          : - TIM1_ForcedAction: specifies the forced Action to be set to
   1482          *                    the output waveform.
   1483          *                    This parameter can be one of the following values:
   1484          *                       - TIM1_ForcedAction_Active: Force active level on OC3REF
   1485          *                       - TIM1_ForcedAction_InActive: Force inactive level on
   1486          *                         OC3REF.
   1487          * Output         : None
   1488          * Return         : None
   1489          *******************************************************************************/
   1490          void TIM1_ForcedOC3Config(u16 TIM1_ForcedAction)
   1491          {
   1492            u32 tmpccmr2 = 0;
   1493          
   1494            /* Check the parameters */
   1495            assert(IS_TIM1_FORCED_ACTION(TIM1_ForcedAction));
   1496          
   1497            tmpccmr2 = TIM1->CCMR2;
   1498          
   1499            /* Reset the OCM Bits */
   1500            tmpccmr2 &= CCMR_OCM13_Mask;
   1501          
   1502            /* Configure The Forced output Mode */
   1503            tmpccmr2 |= TIM1_ForcedAction;
   1504          
   1505            TIM1->CCMR2 = (u16)tmpccmr2;
   1506          }
   1507          
   1508          /*******************************************************************************
   1509          * Function Name  : TIM1_ForcedOC4Config
   1510          * Description    : Forces the TIM1 Channel4 output waveform to active or inactive 
   1511          *                  level.
   1512          * Input          : - TIM1_ForcedAction: specifies the forced Action to be set to
   1513          *                    the output waveform.
   1514          *                    This parameter can be one of the following values:
   1515          *                       - TIM1_ForcedAction_Active: Force active level on OC4REF
   1516          *                       - TIM1_ForcedAction_InActive: Force inactive level on
   1517          *                         OC4REF.
   1518          * Output         : None
   1519          * Return         : None
   1520          *******************************************************************************/
   1521          void TIM1_ForcedOC4Config(u16 TIM1_ForcedAction)
   1522          {
   1523            u32 tmpccmr2 = 0;
   1524          
   1525            /* Check the parameters */
   1526            assert(IS_TIM1_FORCED_ACTION(TIM1_ForcedAction));
   1527          
   1528            tmpccmr2 = TIM1->CCMR1;
   1529          
   1530            /* Reset the OCM Bits */
   1531            tmpccmr2 &= CCMR_OCM24_Mask;
   1532          
   1533            /* Configure The Forced output Mode */
   1534            tmpccmr2 |= (u16)((u16)TIM1_ForcedAction << 8);
   1535          
   1536            TIM1->CCMR2 = (u16)tmpccmr2;
   1537          }
   1538          
   1539          /*******************************************************************************
   1540          * Function Name  : TIM1_ARRPreloadConfig
   1541          * Description    : Enables or disables TIM1 peripheral Preload register on ARR.
   1542          * Input          : - Newstate: new state of the TIM1 peripheral Preload register
   1543          *                    This parameter can be: ENABLE or DISABLE.
   1544          * Output         : None
   1545          * Return         : None
   1546          *******************************************************************************/
   1547          void TIM1_ARRPreloadConfig(FunctionalState Newstate)
   1548          {
   1549            /* Check the parameters */
   1550            assert(IS_FUNCTIONAL_STATE(Newstate));
   1551          
   1552            /* Set or Reset the ARPE Bit */
   1553            *(vu32 *) CR1_ARPE_BB = (u16)Newstate;
   1554          }
   1555          
   1556          /*******************************************************************************
   1557          * Function Name  : TIM1_SelectCOM
   1558          * Description    : Selects the TIM1 peripheral Commutation event.
   1559          * Input          : - Newstate: new state of the Commutation event.
   1560          *                    This parameter can be: ENABLE or DISABLE.
   1561          * Output         : None
   1562          * Return         : None
   1563          *******************************************************************************/
   1564          void TIM1_SelectCOM(FunctionalState Newstate)
   1565          {
   1566            /* Check the parameters */
   1567            assert(IS_FUNCTIONAL_STATE(Newstate));
   1568          
   1569            /* Set or Reset the CCUS Bit */
   1570            *(vu32 *) CR2_CCUS_BB = (u16)Newstate;
   1571          }
   1572          
   1573          /*******************************************************************************
   1574          * Function Name  : TIM1_SelectCCDMA
   1575          * Description    : Selects the TIM1 peripheral Capture Compare DMA source.
   1576          * Input          : - Newstate: new state of the Capture Compare DMA source
   1577          *                    This parameter can be: ENABLE or DISABLE.
   1578          * Output         : None
   1579          * Return         : None
   1580          *******************************************************************************/
   1581          void TIM1_SelectCCDMA(FunctionalState Newstate)
   1582          {
   1583            /* Check the parameters */
   1584            assert(IS_FUNCTIONAL_STATE(Newstate));
   1585          
   1586            /* Set or Reset the CCDS Bit */
   1587            *(vu32 *) CR2_CCDS_BB = (u16)Newstate;
   1588          }
   1589          
   1590          /*******************************************************************************
   1591          * Function Name  : TIM1_CCPreloadControl
   1592          * Description    : Sets or Resets the TIM1 peripheral Capture Compare Preload 
   1593          *                  Control bit.
   1594          * Input          : - Newstate: new state of the Capture Compare Preload Control bit
   1595          *                    This parameter can be: ENABLE or DISABLE.
   1596          * Output         : None
   1597          * Return         : None
   1598          *******************************************************************************/
   1599          void TIM1_CCPreloadControl(FunctionalState Newstate)
   1600          {
   1601            /* Check the parameters */
   1602            assert(IS_FUNCTIONAL_STATE(Newstate));
   1603          
   1604            /* Set or Reset the CCPC Bit */
   1605            *(vu32 *) CR2_CCPC_BB = (u16)Newstate;
   1606          }
   1607          
   1608          /*******************************************************************************
   1609          * Function Name  : TIM1_OC1PreloadConfig
   1610          * Description    : Enables or disables the TIM1 peripheral Preload Register on CCR1.
   1611          * Input          : - TIM1_OCPreload: new state of the Capture Compare Preload
   1612          *                    register.
   1613          *                    This parameter can be one of the following values:
   1614          *                       - TIM1_OCPreload_Enable
   1615          *                       - TIM1_OCPreload_Disable
   1616          * Output         : None
   1617          * Return         : None
   1618          *******************************************************************************/
   1619          void TIM1_OC1PreloadConfig(u16 TIM1_OCPreload)
   1620          {
   1621            /* Check the parameters */
   1622            assert(IS_TIM1_OCPRELOAD_STATE(TIM1_OCPreload));
   1623          
   1624            /* Set or Reset the OC1PE Bit */
   1625            *(vu32 *) CCMR1_OC1PE_BB = (u16)TIM1_OCPreload;
   1626          }
   1627          
   1628          /*******************************************************************************
   1629          * Function Name  : TIM1_OC2PreloadConfig
   1630          * Description    : Enables or disables the TIM1 peripheral Preload Register on CCR2.
   1631          * Input          : - TIM1_OCPreload: new state of the Capture Compare Preload
   1632          *                    register.
   1633          *                    This parameter can be one of the following values:
   1634          *                       - TIM1_OCPreload_Enable
   1635          *                       - TIM1_OCPreload_Disable
   1636          * Output         : None
   1637          * Return         : None
   1638          *******************************************************************************/
   1639          void TIM1_OC2PreloadConfig(u16 TIM1_OCPreload)
   1640          {
   1641            /* Check the parameters */
   1642            assert(IS_TIM1_OCPRELOAD_STATE(TIM1_OCPreload));
   1643          
   1644            /* Set or Reset the OC2PE Bit */
   1645            *(vu32 *) CCMR1_OC2PE_BB = (u16)TIM1_OCPreload;
   1646          }
   1647          
   1648          /*******************************************************************************
   1649          * Function Name  : TIM1_OC3PreloadConfig
   1650          * Description    : Enables or disables the TIM1 peripheral Preload Register on CCR3.
   1651          * Input          : - TIM1_OCPreload: new state of the Capture Compare Preload
   1652          *                    register.
   1653          *                    This parameter can be one of the following values:
   1654          *                       - TIM1_OCPreload_Enable
   1655          *                       - TIM1_OCPreload_Disable
   1656          * Output         : None
   1657          * Return         : None
   1658          *******************************************************************************/
   1659          void TIM1_OC3PreloadConfig(u16 TIM1_OCPreload)
   1660          {
   1661            /* Check the parameters */
   1662            assert(IS_TIM1_OCPRELOAD_STATE(TIM1_OCPreload));
   1663          
   1664            /* Set or Reset the OC3PE Bit */
   1665            *(vu32 *) CCMR2_OC3PE_BB = (u16)TIM1_OCPreload;
   1666          }
   1667          
   1668          /*******************************************************************************
   1669          * Function Name  : TIM1_OC4PreloadConfig
   1670          * Description    : Enables or disables the TIM1 peripheral Preload Register on CCR4.
   1671          * Input          : - TIM1_OCPreload: new state of the Capture Compare Preload
   1672          *                    register.
   1673          *                    This parameter can be one of the following values:
   1674          *                       - TIM1_OCPreload_Enable
   1675          *                       - TIM1_OCPreload_Disable
   1676          * Output         : None
   1677          * Return         : None
   1678          *******************************************************************************/
   1679          void TIM1_OC4PreloadConfig(u16 TIM1_OCPreload)
   1680          {
   1681            /* Check the parameters */
   1682            assert(IS_TIM1_OCPRELOAD_STATE(TIM1_OCPreload));
   1683          
   1684            /* Set or Reset the OC4PE Bit */
   1685            *(vu32 *) CCMR2_OC4PE_BB = (u16)TIM1_OCPreload;
   1686          }
   1687          
   1688          /*******************************************************************************
   1689          * Function Name  : TIM1_OC1FastConfig
   1690          * Description    : Configures the TIM1 Capture Compare 1 Fast feature.
   1691          * Input          : - TIM1_OCFast: new state of the Output Compare Fast Enable bit.
   1692          *                    This parameter can be one of the following values:
   1693          *                       - TIM1_OCFast_Enable
   1694          *                       - TIM1_OCFast_Disable
   1695          * Output         : None
   1696          * Return         : None
   1697          *******************************************************************************/
   1698          void TIM1_OC1FastConfig(u16 TIM1_OCFast)
   1699          {
   1700            /* Check the parameters */
   1701            assert(IS_TIM1_OCFAST_STATE(TIM1_OCFast));
   1702          
   1703            /* Set or Reset the OC1FE Bit */
   1704            *(vu32 *) CCMR1_OC1FE_BB = (u16)TIM1_OCFast;
   1705          }
   1706          
   1707          /*******************************************************************************
   1708          * Function Name  : TIM1_OC2FastConfig
   1709          * Description    : Configures the TIM1 Capture Compare Fast feature.
   1710          * Input          : - TIM1_OCFast: new state of the Output Compare Fast Enable bit.
   1711          *                    This parameter can be one of the following values:
   1712          *                       - TIM1_OCFast_Enable
   1713          *                       - TIM1_OCFast_Disable
   1714          * Output         : None
   1715          * Return         : None
   1716          *******************************************************************************/
   1717          void TIM1_OC2FastConfig(u16 TIM1_OCFast)
   1718          {
   1719            /* Check the parameters */
   1720            assert(IS_TIM1_OCFAST_STATE(TIM1_OCFast));
   1721          
   1722            /* Set or Reset the OC2FE Bit */
   1723            *(vu32 *) CCMR1_OC2FE_BB = (u16)TIM1_OCFast;
   1724          }
   1725          
   1726          /*******************************************************************************
   1727          * Function Name  : TIM1_OC3FastConfig
   1728          * Description    : Configures the TIM1 Capture Compare Fast feature.
   1729          * Input          : - TIM1_OCFast: new state of the Output Compare Fast Enable bit.
   1730          *                    This parameter can be one of the following values:
   1731          *                       - TIM1_OCFast_Enable
   1732          *                       - TIM1_OCFast_Disable
   1733          * Output         : None
   1734          * Return         : None
   1735          *******************************************************************************/
   1736          void TIM1_OC3FastConfig(u16 TIM1_OCFast)
   1737          {
   1738            /* Check the parameters */
   1739            assert(IS_TIM1_OCFAST_STATE(TIM1_OCFast));
   1740          
   1741            /* Set or Reset the OC3FE Bit */
   1742            *(vu32 *) CCMR2_OC3FE_BB = (u16)TIM1_OCFast;
   1743          }
   1744          
   1745          /*******************************************************************************
   1746          * Function Name  : TIM1_OC4FastConfig
   1747          * Description    : Configures the TIM1 Capture Compare Fast feature.
   1748          * Input          : - TIM1_OCFast: new state of the Output Compare Fast Enable bit.
   1749          *                    This parameter can be one of the following values:
   1750          *                       - TIM1_OCFast_Enable
   1751          *                       - TIM1_OCFast_Disable
   1752          * Output         : None
   1753          * Return         : None
   1754          *******************************************************************************/
   1755          void TIM1_OC4FastConfig(u16 TIM1_OCFast)
   1756          {
   1757            /* Check the parameters */
   1758            assert(IS_TIM1_OCFAST_STATE(TIM1_OCFast));
   1759          
   1760            /* Set or Reset the OC4FE Bit */
   1761            *(vu32 *) CCMR2_OC4FE_BB = (u16)TIM1_OCFast;
   1762          }
   1763          
   1764          /*******************************************************************************
   1765          * Function Name  : TIM1_ClearOC1Ref
   1766          * Description    : Clears or safeguards the OCREF1 signal on an external event
   1767          *                  - TIM1_OCClear: new state of the Output Compare Clear Enable Bit.
   1768          *                    This parameter can be one of the following values:
   1769          *                       - TIM1_OCClear_Enable
   1770          *                       - TIM1_OCClear_Disable
   1771          * Output         : None
   1772          * Return         : None
   1773          *******************************************************************************/
   1774          void TIM1_ClearOC1Ref(u16 TIM1_OCClear)
   1775          {
   1776            /* Check the parameters */
   1777            assert(IS_TIM1_OCCLEAR_STATE(TIM1_OCClear));
   1778          
   1779            /* Set or Reset the OC1CE Bit */
   1780            *(vu32 *) CCMR1_OC1CE_BB = (u16)TIM1_OCClear;
   1781          }
   1782          
   1783          /*******************************************************************************
   1784          * Function Name  : TIM1_ClearOC2Ref
   1785          * Description    : Clears or safeguards the OCREF2 signal on an external event
   1786          *                  - TIM1_OCClear: new state of the Output Compare Clear Enable Bit.
   1787          *                    This parameter can be one of the following values:
   1788          *                       - TIM1_OCClear_Enable
   1789          *                       - TIM1_OCClear_Disable
   1790          * Output         : None
   1791          * Return         : None
   1792          *******************************************************************************/
   1793          void TIM1_ClearOC2Ref(u16 TIM1_OCClear)
   1794          {
   1795            /* Check the parameters */
   1796            assert(IS_TIM1_OCCLEAR_STATE(TIM1_OCClear));
   1797          
   1798            /* Set or Reset the OC2CE Bit */
   1799            *(vu32 *) CCMR1_OC2CE_BB = (u16)TIM1_OCClear;
   1800          }
   1801          
   1802          /*******************************************************************************
   1803          * Function Name  : TIM1_ClearOC3Ref
   1804          * Description    : Clears or safeguards the OCREF3 signal on an external event
   1805          *                  - TIM1_OCClear: new state of the Output Compare Clear Enable Bit.
   1806          *                    This parameter can be one of the following values:
   1807          *                       - TIM1_OCClear_Enable
   1808          *                       - TIM1_OCClear_Disable
   1809          * Output         : None
   1810          * Return         : None
   1811          *******************************************************************************/
   1812          void TIM1_ClearOC3Ref(u16 TIM1_OCClear)
   1813          {
   1814            /* Check the parameters */
   1815            assert(IS_TIM1_OCCLEAR_STATE(TIM1_OCClear));
   1816          
   1817            /* Set or Reset the OC3CE Bit */
   1818            *(vu32 *) CCMR2_OC3CE_BB = (u16)TIM1_OCClear;
   1819          }
   1820          
   1821          /*******************************************************************************
   1822          * Function Name  : TIM1_ClearOC4Ref
   1823          * Description    : Clears or safeguards the OCREF4 signal on an external event
   1824          *                  - TIM1_OCClear: new state of the Output Compare Clear Enable Bit.
   1825          *                    This parameter can be one of the following values:
   1826          *                       - TIM1_OCClear_Enable
   1827          *                       - TIM1_OCClear_Disable
   1828          * Output         : None
   1829          * Return         : None
   1830          *******************************************************************************/
   1831          void TIM1_ClearOC4Ref(u16 TIM1_OCClear)
   1832          {
   1833            /* Check the parameters */
   1834            assert(IS_TIM1_OCCLEAR_STATE(TIM1_OCClear));
   1835          
   1836            /* Set or Reset the OC4CE Bit */
   1837            *(vu32 *) CCMR2_OC4CE_BB = (u16)TIM1_OCClear;
   1838          }
   1839          
   1840          /*******************************************************************************
   1841          * Function Name  : TIM1_GenerateEvent
   1842          * Description    : Configures the TIM1 event to be generate by software.
   1843          * Input          : - TIM1_EventSource: specifies the event source.
   1844          *                    This parameter can be one or more of the following values:
   1845          *                       - TIM1_EventSource_Update: TIM1 update Event source
   1846          *                       - TIM1_EventSource_CC1: TIM1 Capture Compare 1 Event source
   1847          *                       - TIM1_EventSource_CC2: TIM1 Capture Compare 2 Event source
   1848          *                       - TIM1_EventSource_CC3: TIM1 Capture Compare 3 Event source
   1849          *                       - TIM1_EventSource_CC4: TIM1 Capture Compare 4 Event source
   1850          *                       - TIM1_EventSource_COM: TIM1 COM Event source
   1851          *                       - TIM1_EventSource_Trigger: TIM1 Trigger Event source
   1852          *                       - TIM1_EventSourceBreak: TIM1 Break Event source
   1853          * Output         : None
   1854          * Return         : None
   1855          *******************************************************************************/
   1856          void TIM1_GenerateEvent(u16 TIM1_EventSource)
   1857          {
   1858            /* Check the parameters */
   1859            assert(IS_TIM1_EVENT_SOURCE(TIM1_EventSource));
   1860          
   1861            /* Set the event sources */
   1862            TIM1->EGR |= TIM1_EventSource;
   1863          }
   1864          
   1865          /*******************************************************************************
   1866          * Function Name  : TIM1_OC1PolarityConfig
   1867          * Description    : Configures the TIM1 Channel 1 polarity.
   1868          * Input          : - TIM1_OCPolarity: specifies the OC1 Polarity
   1869          *                    This parmeter can be one of the following values:
   1870          *                       - TIM1_OCPolarity_High: Output Compare active high
   1871          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1872          * Output         : None
   1873          * Return         : None
   1874          *******************************************************************************/
   1875          void TIM1_OC1PolarityConfig(u16 TIM1_OCPolarity)
   1876          {
   1877            /* Check the parameters */
   1878            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1879          
   1880            /* Set or Reset the CC1P Bit */
   1881            *(vu32 *) CCER_CC1P_BB = (u16)TIM1_OCPolarity;
   1882          }
   1883          
   1884          /*******************************************************************************
   1885          * Function Name  : TIM1_OC1NPolarityConfig
   1886          * Description    : Configures the TIM1 Channel 1N polarity.
   1887          * Input          : - TIM1_OCPolarity: specifies the OC1N Polarity
   1888          *                    This parmeter can be one of the following values:
   1889          *                       - TIM1_OCPolarity_High: Output Compare active high
   1890          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1891          * Output         : None
   1892          * Return         : None
   1893          *******************************************************************************/
   1894          void TIM1_OC1NPolarityConfig(u16 TIM1_OCPolarity)
   1895          {
   1896            /* Check the parameters */
   1897            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1898          
   1899            /* Set or Reset the CC3P Bit */
   1900            *(vu32 *) CCER_CC1NP_BB = (u16)TIM1_OCPolarity;
   1901          }
   1902          
   1903          /*******************************************************************************
   1904          * Function Name  : TIM1_OC2PolarityConfig
   1905          * Description    : Configures the TIM1 Channel 2 polarity.
   1906          * Input          : - TIM1_OCPolarity: specifies the OC2 Polarity
   1907          *                    This parmeter can be one of the following values:
   1908          *                       - TIM1_OCPolarity_High: Output Compare active high
   1909          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1910          * Output         : None
   1911          * Return         : None
   1912          *******************************************************************************/
   1913          void TIM1_OC2PolarityConfig(u16 TIM1_OCPolarity)
   1914          {
   1915            /* Check the parameters */
   1916            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1917          
   1918            /* Set or Reset the CC2P Bit */
   1919            *(vu32 *) CCER_CC2P_BB = (u16)TIM1_OCPolarity;
   1920          }
   1921          
   1922          /*******************************************************************************
   1923          * Function Name  : TIM1_OC2NPolarityConfig
   1924          * Description    : Configures the TIM1 Channel 2N polarity.
   1925          * Input          : - TIM1_OCPolarity: specifies the OC2N Polarity
   1926          *                    This parmeter can be one of the following values:
   1927          *                       - TIM1_OCPolarity_High: Output Compare active high
   1928          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1929          * Output         : None
   1930          * Return         : None
   1931          *******************************************************************************/
   1932          void TIM1_OC2NPolarityConfig(u16 TIM1_OCPolarity)
   1933          {
   1934            /* Check the parameters */
   1935            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1936          
   1937            /* Set or Reset the CC3P Bit */
   1938            *(vu32 *) CCER_CC2NP_BB = (u16)TIM1_OCPolarity;
   1939          }
   1940          
   1941          /*******************************************************************************
   1942          * Function Name  : TIM1_OC3PolarityConfig
   1943          * Description    : Configures the TIM1 Channel 3 polarity.
   1944          * Input          : - TIM1_OCPolarity: specifies the OC3 Polarity
   1945          *                    This parmeter can be one of the following values:
   1946          *                       - TIM1_OCPolarity_High: Output Compare active high
   1947          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1948          * Output         : None
   1949          * Return         : None
   1950          *******************************************************************************/
   1951          void TIM1_OC3PolarityConfig(u16 TIM1_OCPolarity)
   1952          {
   1953            /* Check the parameters */
   1954            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1955          
   1956            /* Set or Reset the CC3P Bit */
   1957            *(vu32 *) CCER_CC3P_BB = (u16)TIM1_OCPolarity;
   1958          }
   1959          
   1960          /*******************************************************************************
   1961          * Function Name  : TIM1_OC3NPolarityConfig
   1962          * Description    : Configures the TIM1 Channel 3N polarity.
   1963          * Input          : - TIM1_OCPolarity: specifies the OC3N Polarity
   1964          *                    This parmeter can be one of the following values:
   1965          *                       - TIM1_OCPolarity_High: Output Compare active high
   1966          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1967          * Output         : None
   1968          * Return         : None
   1969          *******************************************************************************/
   1970          void TIM1_OC3NPolarityConfig(u16 TIM1_OCPolarity)
   1971          {
   1972            /* Check the parameters */
   1973            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1974          
   1975            /* Set or Reset the CC3P Bit */
   1976            *(vu32 *) CCER_CC3NP_BB = (u16)TIM1_OCPolarity;
   1977          }
   1978          
   1979          /*******************************************************************************
   1980          * Function Name  : TIM1_OC4PolarityConfig
   1981          * Description    : Configures the TIM1 Channel 4 polarity.
   1982          * Input          : - TIM1_OCPolarity: specifies the OC4 Polarity
   1983          *                    This parmeter can be one of the following values:
   1984          *                       - TIM1_OCPolarity_High: Output Compare active high
   1985          *                       - TIM1_OCPolarity_Low: Output Compare active low
   1986          * Output         : None
   1987          * Return         : None
   1988          *******************************************************************************/
   1989          void TIM1_OC4PolarityConfig(u16 TIM1_OCPolarity)
   1990          {
   1991            /* Check the parameters */
   1992            assert(IS_TIM1_OC_POLARITY(TIM1_OCPolarity));
   1993          
   1994            /* Set or Reset the CC4P Bit */
   1995            *(vu32 *) CCER_CC4P_BB = (u16)TIM1_OCPolarity;
   1996          }
   1997          
   1998          /*******************************************************************************
   1999          * Function Name  : TIM1_CCxCmd
   2000          * Description    : Enables or disables the TIM1 Capture Compare Channel x.
   2001          * Input          : - TIM1_Channel: specifies the TIM1 Channel
   2002          *                    This parmeter can be one of the following values:
   2003          *                       - TIM1_Channel1: TIM1 Channel1
   2004          *                       - TIM1_Channel2: TIM1 Channel2
   2005          *                       - TIM1_Channel3: TIM1 Channel3
   2006          *                       - TIM1_Channel4: TIM1 Channel4
   2007          *                 - Newstate: specifies the TIM1 Channel CCxE bit new state.
   2008          *                   This parameter can be: ENABLE or DISABLE. 
   2009          * Output         : None
   2010          * Return         : None
   2011          *******************************************************************************/
   2012          void TIM1_CCxCmd(u16 TIM1_Channel, FunctionalState Newstate)
   2013          {
   2014            /* Check the parameters */
   2015            assert(IS_TIM1_CHANNEL(TIM1_Channel));
   2016            assert(IS_FUNCTIONAL_STATE(Newstate));
   2017          
   2018            if(TIM1_Channel == TIM1_Channel_1)
   2019            {
   2020              /* Set or Reset the CC1E Bit */
   2021              *(vu32 *) CCER_CC1E_BB = (u16)Newstate;  
   2022            }
   2023            else if(TIM1_Channel == TIM1_Channel_2)
   2024            {
   2025              /* Set or Reset the CC2E Bit */
   2026              *(vu32 *) CCER_CC2E_BB = (u16)Newstate;
   2027            }
   2028            else if(TIM1_Channel == TIM1_Channel_3)
   2029            {
   2030              /* Set or Reset the CC3E Bit */
   2031              *(vu32 *) CCER_CC3E_BB = (u16)Newstate;
   2032            }
   2033            else
   2034            {
   2035              /* Set or Reset the CC4E Bit */
   2036              *(vu32 *) CCER_CC4E_BB = (u16)Newstate;
   2037            }
   2038          }
   2039          
   2040          /*******************************************************************************
   2041          * Function Name  : TIM1_CCxNCmd
   2042          * Description    : Enables or disables the TIM1 Capture Compare Channel xN.
   2043          * Input          : - TIM1_Channel: specifies the TIM1 Channel
   2044          *                    This parmeter can be one of the following values:
   2045          *                       - TIM1_Channel1: TIM1 Channel1
   2046          *                       - TIM1_Channel2: TIM1 Channel2
   2047          *                       - TIM1_Channel3: TIM1 Channel3
   2048          *                 - Newstate: specifies the TIM1 Channel CCxNE bit new state.
   2049          *                   This parameter can be: ENABLE or DISABLE. 
   2050          * Output         : None
   2051          * Return         : None
   2052          *******************************************************************************/
   2053          void TIM1_CCxNCmd(u16 TIM1_Channel, FunctionalState Newstate)
   2054          {
   2055            /* Check the parameters */
   2056            assert(IS_TIM1_COMPLEMENTARY_CHANNEL(TIM1_Channel));
   2057            assert(IS_FUNCTIONAL_STATE(Newstate));
   2058          
   2059            if(TIM1_Channel == TIM1_Channel_1)
   2060            {
   2061              /* Set or Reset the CC1NE Bit */
   2062              *(vu32 *) CCER_CC1NE_BB = (u16)Newstate;  
   2063            }
   2064            else if(TIM1_Channel == TIM1_Channel_2)
   2065            {
   2066              /* Set or Reset the CC2NE Bit */
   2067              *(vu32 *) CCER_CC2NE_BB = (u16)Newstate;
   2068            }
   2069            else 
   2070            {
   2071              /* Set or Reset the CC3NE Bit */
   2072              *(vu32 *) CCER_CC3NE_BB = (u16)Newstate;
   2073            }
   2074          }
   2075          
   2076          /*******************************************************************************
   2077          * Function Name  : TIM1_SelectOCxM
   2078          * Description    : Selects the TIM1 Ouput Compare Mode.
   2079          *                  This function disables the selected channel before changing 
   2080          *                  the Ouput Compare Mode. User has to enable this channel using
   2081          *                  TIM1_CCxCmd and TIM1_CCxNCmd functions.
   2082          * Input          : - TIM1_Channel: specifies the TIM1 Channel
   2083          *                    This parmeter can be one of the following values:
   2084          *                       - TIM1_Channel1: TIM1 Channel1
   2085          *                       - TIM1_Channel2: TIM1 Channel2
   2086          *                       - TIM1_Channel3: TIM1 Channel3
   2087          *                       - TIM1_Channel4: TIM1 Channel4
   2088          *                  - TIM1_OCMode: specifies the TIM1 Output Compare Mode.
   2089          *                    This paramter can be one of the following values:
   2090          *                       - TIM1_OCMode_Timing
   2091          *                       - TIM1_OCMode_Active
   2092          *                       - TIM1_OCMode_Toggle
   2093          *                       - TIM1_OCMode_PWM1
   2094          *                       - TIM1_OCMode_PWM2
   2095          *                       - TIM1_ForcedAction_Active
   2096          *                       - TIM1_ForcedAction_InActive
   2097          * Output         : None
   2098          * Return         : None
   2099          *******************************************************************************/
   2100          void TIM1_SelectOCxM(u16 TIM1_Channel, u16 TIM1_OCMode)
   2101          {
   2102            /* Check the parameters */
   2103            assert(IS_TIM1_CHANNEL(TIM1_Channel));
   2104            assert(IS_TIM1_OCM(TIM1_OCMode));
   2105          
   2106            if(TIM1_Channel == TIM1_Channel_1)
   2107            {
   2108              /* Disable the Channel 1: Reset the CCE Bit */
   2109              *(vu32 *) CCER_CC1E_BB = CCER_CCE_Reset;
   2110          
   2111              /* Reset the Output Compare Bits */
   2112              TIM1->CCMR1 &= OC13Mode_Mask;
   2113          
   2114              /* Set the Ouput Compare Mode */
   2115              TIM1->CCMR1 |= TIM1_OCMode;
   2116            }
   2117            else if(TIM1_Channel == TIM1_Channel_2)
   2118            {
   2119              /* Disable the Channel 2: Reset the CCE Bit */
   2120              *(vu32 *) CCER_CC2E_BB = CCER_CCE_Reset;
   2121          
   2122              /* Reset the Output Compare Bits */
   2123              TIM1->CCMR1 &= OC24Mode_Mask;
   2124          
   2125              /* Set the Ouput Compare Mode */
   2126              TIM1->CCMR1 |= (u16)((u16)TIM1_OCMode << 8);
   2127            }
   2128            else if(TIM1_Channel == TIM1_Channel_3)
   2129            {
   2130              /* Disable the Channel 3: Reset the CCE Bit */
   2131              *(vu32 *) CCER_CC3E_BB = CCER_CCE_Reset;
   2132          
   2133              /* Reset the Output Compare Bits */
   2134              TIM1->CCMR2 &= OC13Mode_Mask;
   2135          
   2136              /* Set the Ouput Compare Mode */
   2137              TIM1->CCMR2 |= TIM1_OCMode;
   2138            }
   2139            else
   2140            {
   2141              /* Disable the Channel 4: Reset the CCE Bit */
   2142              *(vu32 *) CCER_CC4E_BB = CCER_CCE_Reset;
   2143          
   2144              /* Reset the Output Compare Bits */
   2145              TIM1->CCMR2 &= OC24Mode_Mask;
   2146          
   2147              /* Set the Ouput Compare Mode */
   2148              TIM1->CCMR2 |= (u16)((u16)TIM1_OCMode << 8);
   2149            }
   2150          }
   2151          
   2152          /*******************************************************************************
   2153          * Function Name  : TIM1_SetCounter
   2154          * Description    : Sets the TIM1 Counter Register value
   2155          * Input          : - Counter: specifies the Counter register new value.
   2156          * Output         : None
   2157          * Return         : None
   2158          *******************************************************************************/
   2159          void TIM1_SetCounter(u16 Counter)
   2160          {
   2161            /* Set the Counter Register value */
   2162            TIM1->CNT = Counter;
   2163          }
   2164          
   2165          /*******************************************************************************
   2166          * Function Name  : TIM1_SetAutoreload
   2167          * Description    : Sets the TIM1 Autoreload Register value.
   2168          * Input          : - Autoreload: specifies the Autoreload register new value.
   2169          * Output         : None
   2170          * Return         : None
   2171          *******************************************************************************/
   2172          void TIM1_SetAutoreload(u16 Autoreload)
   2173          {
   2174            /* Set the Autoreload Register value */
   2175            TIM1->ARR = Autoreload;
   2176          }
   2177          
   2178          /*******************************************************************************
   2179          * Function Name  : TIM1_SetCompare1
   2180          * Description    : Sets the TIM1 Capture Compare1 Register value.
   2181          * Input          : - Compare1: specifies the Capture Compare1 register new value.
   2182          * Output         : None
   2183          * Return         : None
   2184          *******************************************************************************/
   2185          void TIM1_SetCompare1(u16 Compare1)
   2186          {
   2187            /* Set the Capture Compare1 Register value */
   2188            TIM1->CCR1 = Compare1;
   2189          }
   2190          
   2191          /*******************************************************************************
   2192          * Function Name  : TIM1_SetCompare2
   2193          * Description    : Sets the TIM1 Capture Compare2 Register value.
   2194          * Input          : - Compare2: specifies the Capture Compare2 register new value.
   2195          * Output         : None
   2196          * Return         : None
   2197          *******************************************************************************/
   2198          void TIM1_SetCompare2(u16 Compare2)
   2199          {
   2200            /* Set the Capture Compare2 Register value */
   2201            TIM1->CCR2 = Compare2;
   2202          }
   2203          
   2204          /*******************************************************************************
   2205          * Function Name  : TIM1_SetCompare3
   2206          * Description    : Sets the TIM1 Capture Compare3 Register value.
   2207          * Input          : - Compare3: specifies the Capture Compare3 register new value.
   2208          * Output         : None
   2209          * Return         : None
   2210          *******************************************************************************/
   2211          void TIM1_SetCompare3(u16 Compare3)
   2212          {
   2213            /* Set the Capture Compare3 Register value */
   2214            TIM1->CCR3 = Compare3;
   2215          }
   2216          
   2217          /*******************************************************************************
   2218          * Function Name  : TIM1_SetCompare4
   2219          * Description    : Sets the TIM1 Capture Compare4 Register value.
   2220          * Input          : - Compare4: specifies the Capture Compare4 register new value.
   2221          * Output         : None
   2222          * Return         : None
   2223          *******************************************************************************/
   2224          void TIM1_SetCompare4(u16 Compare4)
   2225          {
   2226            /* Set the Capture Compare4 Register value */
   2227            TIM1->CCR4 = Compare4;
   2228          }
   2229          
   2230          /*******************************************************************************
   2231          * Function Name  : TIM1_SetIC1Prescaler
   2232          * Description    : Sets the TIM1 Input Capture 1 prescaler.
   2233          * Input          : - TIM1_IC1Prescaler: specifies the Input Capture prescaler
   2234          *                    new value.
   2235          *                    This parameter can be one of the following values:
   2236          *                       - TIM1_ICPSC_DIV1: no prescaler
   2237          *                       - TIM1_ICPSC_DIV2: capture is done once every 2 events
   2238          *                       - TIM1_ICPSC_DIV4: capture is done once every 4 events
   2239          *                       - TIM1_ICPSC_DIV8: capture is done once every 8 events
   2240          * Output         : None
   2241          * Return         : None
   2242          *******************************************************************************/
   2243          void TIM1_SetIC1Prescaler(u16 TIM1_IC1Prescaler)
   2244          {
   2245            u32 tmpccmr1 = 0;
   2246            
   2247            /* Check the parameters */
   2248            assert(IS_TIM1_IC_PRESCALER(TIM1_IC1Prescaler));
   2249          
   2250            tmpccmr1 = TIM1->CCMR1;
   2251          
   2252            /* Reset the IC1PSC Bits */
   2253            tmpccmr1 &= CCMR_IC13PSC_Mask;
   2254          
   2255            /* Set the IC1PSC value */
   2256            tmpccmr1 |= TIM1_IC1Prescaler;
   2257          
   2258            TIM1->CCMR1 = (u16)tmpccmr1;
   2259          }
   2260          
   2261          /*******************************************************************************
   2262          * Function Name  : TIM1_SetIC2Prescaler
   2263          * Description    : Sets the TIM1 Input Capture 2 prescaler.
   2264          * Input          : - TIM1_IC2Prescaler: specifies the Input Capture prescaler
   2265          *                    new value.
   2266          *                    This parameter can be one of the following values:
   2267          *                       - TIM1_ICPSC_DIV1: no prescaler
   2268          *                       - TIM1_ICPSC_DIV2: capture is done once every 2 events
   2269          *                       - TIM1_ICPSC_DIV4: capture is done once every 4 events
   2270          *                       - TIM1_ICPSC_DIV8: capture is done once every 8 events
   2271          * Output         : None
   2272          * Return         : None
   2273          *******************************************************************************/
   2274          void TIM1_SetIC2Prescaler(u16 TIM1_IC2Prescaler)
   2275          {
   2276            u32 tmpccmr1 = 0;
   2277          
   2278            /* Check the parameters */
   2279            assert(IS_TIM1_IC_PRESCALER(TIM1_IC2Prescaler));
   2280          
   2281            tmpccmr1 = TIM1->CCMR1;
   2282          
   2283            /* Reset the IC2PSC Bits */
   2284            tmpccmr1 &= CCMR_IC24PSC_Mask;
   2285          
   2286            /* Set the IC2PSC value */
   2287            tmpccmr1 |= (u16)((u16)TIM1_IC2Prescaler << 8);
   2288          
   2289            TIM1->CCMR1 = (u16)tmpccmr1;
   2290          }
   2291          
   2292          /*******************************************************************************
   2293          * Function Name  : TIM1_SetIC3Prescaler
   2294          * Description    : Sets the TIM1 Input Capture 3 prescaler.
   2295          * Input          : - TIM1_IC3Prescaler: specifies the Input Capture prescaler
   2296          *                    new value.
   2297          *                    This parameter can be one of the following values:
   2298          *                       - TIM1_ICPSC_DIV1: no prescaler
   2299          *                       - TIM1_ICPSC_DIV2: capture is done once every 2 events
   2300          *                       - TIM1_ICPSC_DIV4: capture is done once every 4 events
   2301          *                       - TIM1_ICPSC_DIV8: capture is done once every 8 events
   2302          * Output         : None
   2303          * Return         : None
   2304          *******************************************************************************/
   2305          void TIM1_SetIC3Prescaler(u16 TIM1_IC3Prescaler)
   2306          {
   2307            u32 tmpccmr2 = 0;
   2308          
   2309            /* Check the parameters */
   2310            assert(IS_TIM1_IC_PRESCALER(TIM1_IC3Prescaler));
   2311          
   2312            tmpccmr2 = TIM1->CCMR2;
   2313          
   2314            /* Reset the IC3PSC Bits */
   2315            tmpccmr2 &= CCMR_IC13PSC_Mask;
   2316          
   2317            /* Set the IC3PSC value */
   2318            tmpccmr2 |= TIM1_IC3Prescaler;
   2319          
   2320            TIM1->CCMR2 = (u16)tmpccmr2;
   2321          }
   2322          
   2323          /*******************************************************************************
   2324          * Function Name  : TIM1_SetIC4Prescaler
   2325          * Description    : Sets the TIM1 Input Capture 4 prescaler.
   2326          * Input          : - TIM1_IC4Prescaler: specifies the Input Capture prescaler
   2327          *                    new value.
   2328          *                    This parameter can be one of the following values:
   2329          *                       - TIM1_ICPSC_DIV1: no prescaler
   2330          *                       - TIM1_ICPSC_DIV2: capture is done once every 2 events
   2331          *                       - TIM1_ICPSC_DIV4: capture is done once every 4 events
   2332          *                       - TIM1_ICPSC_DIV8: capture is done once every 8 events
   2333          * Output         : None
   2334          * Return         : None
   2335          *******************************************************************************/
   2336          void TIM1_SetIC4Prescaler(u16 TIM1_IC4Prescaler)
   2337          {
   2338            u32 tmpccmr2 = 0;
   2339          
   2340            /* Check the parameters */
   2341            assert(IS_TIM1_IC_PRESCALER(TIM1_IC4Prescaler));
   2342          
   2343            tmpccmr2 = TIM1->CCMR2;
   2344          
   2345            /* Reset the IC4PSC Bits */
   2346            tmpccmr2 &= CCMR_IC24PSC_Mask;
   2347          
   2348            /* Set the IC4PSC value */
   2349            tmpccmr2 |= (u16)((u16)TIM1_IC4Prescaler << 8);
   2350          
   2351            TIM1->CCMR2 = (u16)tmpccmr2;
   2352          }
   2353          
   2354          /*******************************************************************************
   2355          * Function Name  : TIM1_SetClockDivision
   2356          * Description    : Sets the TIM1 Clock Division value.
   2357          * Input          : - TIM1_CKD: specifies the clock division value.
   2358          *                    This parameter can be one of the following value:
   2359          *                       - TIM1_CKD_DIV1: TDTS = Tck_tim
   2360          *                       - TIM1_CKD_DIV2: TDTS = 2*Tck_tim
   2361          *                       - TIM1_CKD_DIV4: TDTS = 4*Tck_tim
   2362          * Output         : None
   2363          * Return         : None
   2364          *******************************************************************************/
   2365          void TIM1_SetClockDivision(u16 TIM1_CKD)
   2366          {
   2367            u32 tmpcr1 = 0;
   2368          
   2369            /* Check the parameters */
   2370            assert(IS_TIM1_CKD_DIV(TIM1_CKD));
   2371          
   2372            tmpcr1 = TIM1->CR1;
   2373          
   2374            /* Reset the CKD Bits */
   2375            tmpcr1 &= CR1_CKD_Mask;
   2376          
   2377            /* Set the CKD value */
   2378            tmpcr1 |= TIM1_CKD;
   2379          
   2380            TIM1->CR1 = (u16)tmpcr1;
   2381          }
   2382          
   2383          /*******************************************************************************
   2384          * Function Name  : TIM1_GetCapture1
   2385          * Description    : Gets the TIM1 Input Capture 1 value.
   2386          * Input          : None
   2387          * Output         : None
   2388          * Return         : Capture Compare 1 Register value.
   2389          *******************************************************************************/
   2390          u16 TIM1_GetCapture1(void)
   2391          {
   2392            /* Get the Capture 1 Register value */
   2393            return TIM1->CCR1;
   2394          }
   2395          
   2396          /*******************************************************************************
   2397          * Function Name  : TIM1_GetCapture2
   2398          * Description    : Gets the TIM1 Input Capture 2 value.
   2399          * Input          : None
   2400          * Output         : None
   2401          * Return         : Capture Compare 2 Register value.
   2402          *******************************************************************************/
   2403          u16 TIM1_GetCapture2(void)
   2404          {
   2405            /* Get the Capture 2 Register value */
   2406            return TIM1->CCR2;
   2407          }
   2408          
   2409          /*******************************************************************************
   2410          * Function Name  : TIM1_GetCapture3
   2411          * Description    : Gets the TIM1 Input Capture 3 value.
   2412          * Input          : None
   2413          * Output         : None
   2414          * Return         : Capture Compare 3 Register value.
   2415          *******************************************************************************/
   2416          u16 TIM1_GetCapture3(void)
   2417          {
   2418            /* Get the Capture 3 Register value */
   2419            return TIM1->CCR3;
   2420          }
   2421          
   2422          /*******************************************************************************
   2423          * Function Name  : TIM1_GetCapture4
   2424          * Description    : Gets the TIM1 Input Capture 4 value.
   2425          * Input          : None
   2426          * Output         : None
   2427          * Return         : Capture Compare 4 Register value.
   2428          *******************************************************************************/
   2429          u16 TIM1_GetCapture4(void)
   2430          {
   2431            /* Get the Capture 4 Register value */
   2432            return TIM1->CCR4;
   2433          }
   2434          
   2435          /*******************************************************************************
   2436          * Function Name  : TIM1_GetCounter
   2437          * Description    : Gets the TIM1 Counter value.
   2438          * Input          : None
   2439          * Output         : None
   2440          * Return         : Counter Register value.
   2441          *******************************************************************************/
   2442          u16 TIM1_GetCounter(void)
   2443          {
   2444            /* Get the Counter Register value */
   2445            return TIM1->CNT;
   2446          }
   2447          
   2448          /*******************************************************************************
   2449          * Function Name  : TIM1_GetPrescaler
   2450          * Description    : Gets the TIM1 Prescaler value.
   2451          * Input          : None
   2452          * Output         : None
   2453          * Return         : Prescaler Register value.
   2454          *******************************************************************************/
   2455          u16 TIM1_GetPrescaler(void)
   2456          {
   2457            /* Get the Prescaler Register value */
   2458            return TIM1->PSC;
   2459          }
   2460          
   2461          /*******************************************************************************
   2462          * Function Name  : TIM1_GetFlagStatus
   2463          * Description    : Checks whether the specified TIM1 flag is set or not.
   2464          * Input          : - TIM1_FLAG: specifies the flag to check.
   2465          *                    This parameter can be one of the following values:
   2466          *                       - TIM1_FLAG_Update: TIM1 update Flag
   2467          *                       - TIM1_FLAG_CC1: TIM1 Capture Compare 1 Flag
   2468          *                       - TIM1_FLAG_CC2: TIM1 Capture Compare 2 Flag
   2469          *                       - TIM1_FLAG_CC3: TIM1 Capture Compare 3 Flag
   2470          *                       - TIM1_FLAG_CC4: TIM1 Capture Compare 4 Flag
   2471          *                       - TIM1_FLAG_COM: TIM1 Commutation Flag
   2472          *                       - TIM1_FLAG_Trigger: TIM1 Trigger Flag
   2473          *                       - TIM1_FLAG_Break: TIM1 Break Flag
   2474          *                       - TIM1_FLAG_CC1OF: TIM1 Capture Compare 1 overcapture Flag
   2475          *                       - TIM1_FLAG_CC2OF: TIM1 Capture Compare 2 overcapture Flag
   2476          *                       - TIM1_FLAG_CC3OF: TIM1 Capture Compare 3 overcapture Flag
   2477          *                       - TIM1_FLAG_CC4OF: TIM1 Capture Compare 4 overcapture Flag
   2478          * Output         : None
   2479          * Return         : The new state of TIM1_FLAG (SET or RESET).
   2480          *******************************************************************************/
   2481          FlagStatus TIM1_GetFlagStatus(u16 TIM1_FLAG)
   2482          {
   2483            FlagStatus bitstatus = RESET;
   2484          
   2485            /* Check the parameters */
   2486            assert(IS_TIM1_GET_FLAG(TIM1_FLAG));
   2487          
   2488            if ((TIM1->SR & TIM1_FLAG) != (u16)RESET )
   2489            {
   2490              bitstatus = SET;
   2491            }
   2492            else
   2493            {
   2494              bitstatus = RESET;
   2495            }
   2496            return bitstatus;
   2497          }
   2498          
   2499          /*******************************************************************************
   2500          * Function Name  : TIM1_ClearFlag
   2501          * Description    : Clears the TIM1s pending flags.
   2502          * Input          : - TIM1_FLAG: specifies the flag to clear.
   2503          *                    This parameter can be any combination of the following values:
   2504          *                       - TIM1_FLAG_Update: TIM1 update Flag
   2505          *                       - TIM1_FLAG_CC1: TIM1 Capture Compare 1 Flag
   2506          *                       - TIM1_FLAG_CC2: TIM1 Capture Compare 2 Flag
   2507          *                       - TIM1_FLAG_CC3: TIM1 Capture Compare 3 Flag
   2508          *                       - TIM1_FLAG_CC4: TIM1 Capture Compare 4 Flag
   2509          *                       - TIM1_FLAG_COM: TIM1 Commutation Flag
   2510          *                       - TIM1_FLAG_Trigger: TIM1 Trigger Flag
   2511          *                       - TIM1_FLAG_Break: TIM1 Break Flag
   2512          *                       - TIM1_FLAG_CC1OF: TIM1 Capture Compare 1 overcapture Flag
   2513          *                       - TIM1_FLAG_CC2OF: TIM1 Capture Compare 2 overcapture Flag
   2514          *                       - TIM1_FLAG_CC3OF: TIM1 Capture Compare 3 overcapture Flag
   2515          *                       - TIM1_FLAG_CC4OF: TIM1 Capture Compare 4 overcapture Flag
   2516          * Output         : None
   2517          * Return         : None
   2518          *******************************************************************************/
   2519          void TIM1_ClearFlag(u16 TIM1_FLAG)
   2520          {
   2521            /* Check the parameters */
   2522            assert(IS_TIM1_CLEAR_FLAG(TIM1_FLAG));
   2523          
   2524            /* Clear the flags */
   2525            TIM1->SR &= (u16)~TIM1_FLAG;
   2526          }
   2527          
   2528          /*******************************************************************************
   2529          * Function Name  : TIM1_GetITStatus
   2530          * Description    : Checks whether the TIM1 interrupt has occurred or not.
   2531          * Input          : - TIM1_IT: specifies the TIM1 interrupt source to check.
   2532          *                    This parameter can be one of the following values:
   2533          *                       - TIM1_IT_Update: TIM1 update Interrupt source
   2534          *                       - TIM1_IT_CC1: TIM1 Capture Compare 1 Interrupt source
   2535          *                       - TIM1_IT_CC2: TIM1 Capture Compare 2 Interrupt source
   2536          *                       - TIM1_IT_CC3: TIM1 Capture Compare 3 Interrupt source
   2537          *                       - TIM1_IT_CC4: TIM1 Capture Compare 4 Interrupt source
   2538          *                       - TIM1_IT_COM: TIM1 Commutation Interrupt
   2539          *                         source
   2540          *                       - TIM1_IT_Trigger: TIM1 Trigger Interrupt source
   2541          *                       - TIM1_IT_Break: TIM1 Break Interrupt source
   2542          * Output         : None
   2543          * Return         : The new state of the TIM1_IT(SET or RESET).
   2544          *******************************************************************************/
   2545          ITStatus TIM1_GetITStatus(u16 TIM1_IT)
   2546          {
   2547            ITStatus bitstatus = RESET;
   2548            
   2549            u16 TIM1_itStatus = 0x0, TIM1_itEnable = 0x0;
   2550          
   2551            /* Check the parameters */
   2552            assert(IS_TIM1_GET_IT(TIM1_IT));
   2553            
   2554            TIM1_itStatus = TIM1->SR & TIM1_IT;
   2555            
   2556            TIM1_itEnable = TIM1->DIER & TIM1_IT;
   2557          
   2558            if ((TIM1_itStatus != (u16)RESET ) && (TIM1_itEnable != (u16)RESET ))
   2559            {
   2560              bitstatus = SET;
   2561            }
   2562            else
   2563            {
   2564              bitstatus = RESET;
   2565            }
   2566            return bitstatus;
   2567          }
   2568          
   2569          /*******************************************************************************
   2570          * Function Name  : TIM1_ClearITPendingBit
   2571          * Description    : Clears the TIM1's interrupt pending bits.
   2572          * Input          : - TIM1_IT: specifies the pending bit to clear.
   2573          *                    This parameter can be any combination of the following values:
   2574          *                       - TIM1_IT_Update: TIM1 update Interrupt source
   2575          *                       - TIM1_IT_CC1: TIM1 Capture Compare 1 Interrupt source
   2576          *                       - TIM1_IT_CC2: TIM1 Capture Compare 2 Interrupt source
   2577          *                       - TIM1_IT_CC3: TIM1 Capture Compare 3 Interrupt source
   2578          *                       - TIM1_IT_CC4: TIM1 Capture Compare 4 Interrupt source
   2579          *                       - TIM1_IT_COM: TIM1 Commutation Interrupt
   2580          *                         source
   2581          *                       - TIM1_IT_Trigger: TIM1 Trigger Interrupt source
   2582          *                       - TIM1_IT_Break: TIM1 Break Interrupt source
   2583          * Output         : None
   2584          * Return         : None
   2585          *******************************************************************************/
   2586          void TIM1_ClearITPendingBit(u16 TIM1_IT)
   2587          {
   2588            /* Check the parameters */
   2589            assert(IS_TIM1_IT(TIM1_IT));
   2590          
   2591            /* Clear the IT pending Bit */
   2592            TIM1->SR &= (u16)~TIM1_IT;
   2593          }
   2594          
   2595          /*******************************************************************************
   2596          * Function Name  : TI1_Config
   2597          * Description    : Configure the TI1 as Input.
   2598          * Input          : - TIM1_ICPolarity : The Input Polarity.
   2599          *                    This parameter can be one of the following values:
   2600          *                       - TIM1_ICPolarity_Rising
   2601          *                       - TIM1_ICPolarity_Falling
   2602          *                  - TIM1_ICSelection: specifies the input to be used.
   2603          *                    This parameter can be one of the following values:
   2604          *                       - TIM1_ICSelection_DirectTI: TIM1 Input 1 is selected to
   2605          *                         be connected to IC1.
   2606          *                       - TIM1_ICSelection_IndirectTI: TIM1 Input 1 is selected to
   2607          *                         be connected to IC2.
   2608          *                       - TIM1_ICSelection_TRGI:TIM1 Input 1 is selected to be
   2609          *                         connected to TRGI.
   2610          *                  - TIM1_ICFilter: Specifies the Input Capture Filter.
   2611          *                    This parameter must be a value between 0x00 and 0x0F.
   2612          * Output         : None
   2613          * Return         : None
   2614          *******************************************************************************/
   2615          static void TI1_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
   2616                                 u8 TIM1_ICFilter)
   2617          {
   2618            u32 tmpccmr1 = 0;
   2619          
   2620            tmpccmr1 = TIM1->CCMR1;
   2621          
   2622            /* Disable the Channel 1: Reset the CCE Bit */
   2623            *(vu32 *) CCER_CC1E_BB = CCER_CCE_Reset;
   2624          
   2625            /* Select the Input and set the filter */
   2626            tmpccmr1 &= CCMR_CC13S_Mask & CCMR_IC13F_Mask;
   2627            tmpccmr1 |= (u16)TIM1_ICSelection | (u16)((u16)TIM1_ICFilter << 4);
   2628          
   2629            TIM1->CCMR1 = (u16)tmpccmr1;
   2630          
   2631            /* Select the Polarity */
   2632            *(vu32 *) CCER_CC1P_BB = TIM1_ICPolarity;
   2633          
   2634            /* Set the CCE Bit */
   2635            *(vu32 *) CCER_CC1E_BB = CCER_CCE_Set;
   2636          }
   2637          
   2638          /*******************************************************************************
   2639          * Function Name  : TI2_Config
   2640          * Description    : Configure the TI2 as Input.
   2641          * Input          : - TIM1_ICPolarity : The Input Polarity.
   2642          *                    This parameter can be one of the following values:
   2643          *                       - TIM1_ICPolarity_Rising
   2644          *                       - TIM1_ICPolarity_Falling
   2645          *                  - TIM1_ICSelection: specifies the input to be used.
   2646          *                    This parameter can be one of the following values:
   2647          *                       - TIM1_ICSelection_DirectTI: TIM1 Input 2 is selected to
   2648          *                         be connected to IC2.
   2649          *                       - TIM1_ICSelection_IndirectTI: TIM1 Input 2 is selected to
   2650          *                         be connected to IC1.
   2651          *                       - TIM1_ICSelection_TRGI: TIM1 Input 2 is selected to be
   2652          *                         connected to TRGI.
   2653          *                  - TIM1_ICFilter: Specifies the Input Capture Filter.
   2654          *                    This parameter must be a value between 0x00 and 0x0F.
   2655          * Output         : None
   2656          * Return         : None
   2657          *******************************************************************************/
   2658          static void TI2_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
   2659                                 u8 TIM1_ICFilter)
   2660          {
   2661            u32 tmpccmr1 = 0;
   2662          
   2663            tmpccmr1 = TIM1->CCMR1;
   2664          
   2665            /* Disable the Channel 2: Reset the CCE Bit */
   2666            *(vu32 *) CCER_CC2E_BB = CCER_CCE_Reset;
   2667          
   2668            /* Select the Input and set the filter */
   2669            tmpccmr1 &= CCMR_CC24S_Mask & CCMR_IC24F_Mask;
   2670            tmpccmr1 |= (u16)((u16)TIM1_ICSelection << 8) | (u16)((u16)TIM1_ICFilter <<12);
   2671          
   2672            TIM1->CCMR1 = (u16)tmpccmr1;
   2673          
   2674            /* Select the Polarity */
   2675            *(vu32 *) CCER_CC2P_BB = TIM1_ICPolarity;
   2676          
   2677            /* Set the CCE Bit */
   2678            *(vu32 *) CCER_CC2E_BB = CCER_CCE_Set;
   2679          
   2680          }
   2681          
   2682          /*******************************************************************************
   2683          * Function Name  : TI3_Config
   2684          * Description    : Configure the TI3 as Input.
   2685          * Input          : - TIM1_ICPolarity : The Input Polarity.
   2686          *                    This parameter can be one of the following values:
   2687          *                       - TIM1_ICPolarity_Rising
   2688          *                       - TIM1_ICPolarity_Falling
   2689          *                  - TIM1_ICSelection: specifies the input to be used.
   2690          *                    This parameter can be one of the following values:
   2691          *                       - TIM1_ICSelection_DirectTI: TIM1 Input 3 is selected to
   2692          *                         be connected to IC3.
   2693          *                       - TIM1_ICSelection_IndirectTI: TIM1 Input 3 is selected to
   2694          *                         be connected to IC4.
   2695          *                       - TIM1_ICSelection_TRGI: TIM1 Input 3 is selected to be
   2696          *                         connected to TRGI.
   2697          *                  - TIM1_ICFilter: Specifies the Input Capture Filter.
   2698          *                    This parameter must be a value between 0x00 and 0x0F.
   2699          * Output         : None
   2700          * Return         : None
   2701          *******************************************************************************/
   2702          static void TI3_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
   2703                                 u8 TIM1_ICFilter)
   2704          {
   2705            u32 tmpccmr2 = 0;
   2706          
   2707            tmpccmr2 = TIM1->CCMR2;
   2708          
   2709            /* Disable the Channel 3: Reset the CCE Bit */
   2710            *(vu32 *) CCER_CC3E_BB = CCER_CCE_Reset;
   2711          
   2712            /* Select the Input and set the filter */
   2713            tmpccmr2 &= CCMR_CC13S_Mask & CCMR_IC13F_Mask;
   2714            tmpccmr2 |= (u16)TIM1_ICSelection | (u16)((u16)TIM1_ICFilter << 4);
   2715          
   2716            TIM1->CCMR2 = (u16)tmpccmr2;
   2717          
   2718            /* Select the Polarity */
   2719            *(vu32 *) CCER_CC3P_BB = TIM1_ICPolarity;
   2720          
   2721            /* Set the CCE Bit */
   2722            *(vu32 *) CCER_CC3E_BB = CCER_CCE_Set;
   2723          }
   2724          
   2725          /*******************************************************************************
   2726          * Function Name  : TI4_Config
   2727          * Description    : Configure the TI4 as Input.
   2728          * Input          : - TIM1_ICPolarity : The Input Polarity.
   2729          *                    This parameter can be one of the following values:
   2730          *                       - TIM1_ICPolarity_Rising
   2731          *                       - TIM1_ICPolarity_Falling
   2732          *                  - TIM1_ICSelection: specifies the input to be used.
   2733          *                    This parameter can be one of the following values:
   2734          *                       - TIM1_ICSelection_DirectTI: TIM1 Input 4 is selected to
   2735          *                         be connected to IC4.
   2736          *                       - TIM1_ICSelection_IndirectTI: TIM1 Input 4 is selected to
   2737          *                         be connected to IC3.
   2738          *                       - TIM1_ICSelection_TRGI: TIM1 Input 4 is selected to be
   2739          *                         connected to TRGI.
   2740          *                  - TIM1_ICFilter: Specifies the Input Capture Filter.
   2741          *                    This parameter must be a value between 0x00 and 0x0F.
   2742          * Output         : None
   2743          * Return         : None
   2744          *******************************************************************************/
   2745          static void TI4_Config(u16 TIM1_ICPolarity, u16 TIM1_ICSelection,
   2746                                 u8 TIM1_ICFilter)
   2747          {
   2748            u32 tmpccmr2 = 0;
   2749          
   2750            tmpccmr2 = TIM1->CCMR2;
   2751            
   2752            /* Disable the Channel 4: Reset the CCE Bit */
   2753            *(vu32 *) CCER_CC4E_BB = CCER_CCE_Reset;
   2754          
   2755            /* Select the Input and set the filter */
   2756            tmpccmr2 &= CCMR_CC24S_Mask & CCMR_IC24F_Mask;
   2757            tmpccmr2 |= (u16)((u16)TIM1_ICSelection << 8) | (u16)((u16)TIM1_ICFilter << 12);
   2758          
   2759            TIM1->CCMR2 = (u16)tmpccmr2;
   2760          
   2761            /* Select the Polarity */
   2762            *(vu32 *) CCER_CC4P_BB = TIM1_ICPolarity;
   2763          
   2764            /* Set the CCE Bit */
   2765            *(vu32 *) CCER_CC4E_BB = CCER_CCE_Set;
   2766          }
   2767          /******************* (C) COPYRIGHT 2007 STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

     Function                     CSTACK
     --------                     ------
     TI1_Config                       8
     TI2_Config                       8
     TI3_Config                       8
     TI4_Config                       8
     TIM1_ARRPreloadConfig            8
     TIM1_BDTRConfig                  8
     TIM1_BDTRStructInit              0
     TIM1_CCPreloadControl            8
     TIM1_CCxCmd                     12
     TIM1_CCxNCmd                    12
     TIM1_ClearFlag                   8
     TIM1_ClearITPendingBit           8
     TIM1_ClearOC1Ref                 8
     TIM1_ClearOC2Ref                 8
     TIM1_ClearOC3Ref                 8
     TIM1_ClearOC4Ref                 8
     TIM1_Cmd                         8
     TIM1_CounterModeConfig           8
     TIM1_CtrlPWMOutputs              8
     TIM1_DMACmd                     12
     TIM1_DMAConfig                  12
     TIM1_DeInit                      4
     TIM1_ETRClockMode1Config        16
     TIM1_ETRClockMode2Config        16
     TIM1_ETRConfig                   4
     TIM1_EncoderInterfaceConfig     16
     TIM1_ForcedOC1Config             8
     TIM1_ForcedOC2Config             8
     TIM1_ForcedOC3Config             8
     TIM1_ForcedOC4Config             8
     TIM1_GenerateEvent               8
     TIM1_GetCapture1                 0
     TIM1_GetCapture2                 0
     TIM1_GetCapture3                 0
     TIM1_GetCapture4                 0
     TIM1_GetCounter                  0
     TIM1_GetFlagStatus               8
     TIM1_GetITStatus                 8
     TIM1_GetPrescaler                0
     TIM1_ICInit                      8
     TIM1_ICStructInit                0
     TIM1_ITConfig                   12
     TIM1_ITRxExternalClockConfig     8
     TIM1_InternalClockConfig         0
     TIM1_OC1FastConfig               8
     TIM1_OC1Init                     8
     TIM1_OC1NPolarityConfig          8
     TIM1_OC1PolarityConfig           8
     TIM1_OC1PreloadConfig            8
     TIM1_OC2FastConfig               8
     TIM1_OC2Init                     8
     TIM1_OC2NPolarityConfig          8
     TIM1_OC2PolarityConfig           8
     TIM1_OC2PreloadConfig            8
     TIM1_OC3FastConfig               8
     TIM1_OC3Init                     8
     TIM1_OC3NPolarityConfig          8
     TIM1_OC3PolarityConfig           8
     TIM1_OC3PreloadConfig            8
     TIM1_OC4FastConfig               8
     TIM1_OC4Init                     8
     TIM1_OC4PolarityConfig           8
     TIM1_OC4PreloadConfig            8
     TIM1_OCStructInit                0
     TIM1_PWMIConfig                 16
     TIM1_PrescalerConfig            12
     TIM1_SelectCCDMA                 8
     TIM1_SelectCOM                   8
     TIM1_SelectHallSensor            8
     TIM1_SelectInputTrigger          8
     TIM1_SelectMasterSlaveMode       8
     TIM1_SelectOCxM                 12
     TIM1_SelectOnePulseMode          8
     TIM1_SelectOutputTrigger         8
     TIM1_SelectSlaveMode             8
     TIM1_SetAutoreload               0
     TIM1_SetClockDivision            8
     TIM1_SetCompare1                 0
     TIM1_SetCompare2                 0
     TIM1_SetCompare3                 0
     TIM1_SetCompare4                 0
     TIM1_SetCounter                  0
     TIM1_SetIC1Prescaler             8
     TIM1_SetIC2Prescaler             8
     TIM1_SetIC3Prescaler             8
     TIM1_SetIC4Prescaler             8
     TIM1_TIxExternalClockConfig     16
     TIM1_TimeBaseInit                8
     TIM1_TimeBaseStructInit          0
     TIM1_UpdateDisableConfig         8
     TIM1_UpdateRequestConfig         8


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     TIM1_DeInit                      24
     TIM1_TimeBaseInit               144
     TIM1_OC1Init                    276
     TIM1_OC2Init                    272
     TIM1_OC3Init                    276
     TIM1_OC4Init                    188
     TIM1_BDTRConfig                 240
     TIM1_ICInit                     236
     TIM1_PWMIConfig                 236
     TIM1_OCStructInit                34
     TIM1_ICStructInit                22
     TIM1_TimeBaseStructInit          28
     TIM1_BDTRStructInit              30
     TIM1_Cmd                         36
     TIM1_CtrlPWMOutputs              32
     TIM1_ITConfig                    84
     TIM1_DMAConfig                  276
     TIM1_DMACmd                      88
     TIM1_InternalClockConfig         18
     TIM1_ETRClockMode1Config        148
     TIM1_ETRClockMode2Config         96
     TIM1_ETRConfig                   48
     TIM1_ITRxExternalClockConfig     56
     TIM1_TIxExternalClockConfig     120
     TIM1_SelectInputTrigger          76
     TIM1_UpdateDisableConfig         36
     TIM1_UpdateRequestConfig         36
     TIM1_SelectHallSensor            36
     TIM1_SelectOnePulseMode          36
     TIM1_SelectOutputTrigger         76
     TIM1_SelectSlaveMode             60
     TIM1_SelectMasterSlaveMode       36
     TIM1_EncoderInterfaceConfig     140
     TIM1_PrescalerConfig             40
     TIM1_CounterModeConfig           68
     TIM1_ForcedOC1Config             52
     TIM1_ForcedOC2Config             48
     TIM1_ForcedOC3Config             52
     TIM1_ForcedOC4Config             56
     TIM1_ARRPreloadConfig            36
     TIM1_SelectCOM                   36
     TIM1_SelectCCDMA                 32
     TIM1_CCPreloadControl            36
     TIM1_OC1PreloadConfig            36
     TIM1_OC2PreloadConfig            36
     TIM1_OC3PreloadConfig            36
     TIM1_OC4PreloadConfig            36
     TIM1_OC1FastConfig               36
     TIM1_OC2FastConfig               32
     TIM1_OC3FastConfig               36
     TIM1_OC4FastConfig               36
     TIM1_ClearOC1Ref                 36
     TIM1_ClearOC2Ref                 36
     TIM1_ClearOC3Ref                 36
     TIM1_ClearOC4Ref                 36
     TIM1_GenerateEvent               44
     TIM1_OC1PolarityConfig           32
     TIM1_OC1NPolarityConfig          32
     TIM1_OC2PolarityConfig           32
     TIM1_OC2NPolarityConfig          32
     TIM1_OC3PolarityConfig           32
     TIM1_OC3NPolarityConfig          32
     TIM1_OC4PolarityConfig           28
     TIM1_CCxCmd                      88
     TIM1_CCxNCmd                     76
     TIM1_SelectOCxM                 248
     TIM1_SetCounter                   8
     TIM1_SetAutoreload                8
     TIM1_SetCompare1                  8
     TIM1_SetCompare2                  8
     TIM1_SetCompare3                  8
     TIM1_SetCompare4                 10
     TIM1_SetIC1Prescaler             60
     TIM1_SetIC2Prescaler             64
     TIM1_SetIC3Prescaler             60
     TIM1_SetIC4Prescaler             64
     TIM1_SetClockDivision            60
     TIM1_GetCapture1                  8
     TIM1_GetCapture2                  8
     TIM1_GetCapture3                  8
     TIM1_GetCapture4                 10
     TIM1_GetCounter                   8
     TIM1_GetPrescaler                 8
     TIM1_GetFlagStatus              100
     TIM1_ClearFlag                   44
     TIM1_GetITStatus                 96
     TIM1_ClearITPendingBit           44
     TI1_Config                       56
     TI2_Config                       62
     TI3_Config                       56
     TI4_Config                       62
     ??DataTable19                     4
     ??DataTable20                     4
     ??DataTable21                     4
     ??DataTable22                     4
     ??DataTable30                     4
     ??DataTable34                     4
     ??DataTable35                     4
     ??DataTable36                     4
     ??DataTable37                     4
     ??DataTable38                     4
     ??DataTable49                     4
     ??DataTable50                     4
     ??DataTable51                     4
     ??DataTable52                     4
     ??DataTable61                     4
     ??DataTable62                     4
     ??DataTable69                     4
     ??DataTable71                     4
     ??DataTable84                     4
     ??DataTable104                    4
     ??DataTable115                    4
     ??DataTable116                    4
     ??DataTable126                    4
     ??DataTable145                    4
     ??DataTable146                    4
     ??DataTable147                    4
     ??DataTable150                    4
     ??DataTable151                    4
     ??DataTable165                    4
     ??DataTable169                    4
     ??DataTable170                    4
     ??DataTable183                    4
     ??DataTable191                    4
     ??DataTable193                    4
     ??DataTable195                    4
     ??DataTable197                    4
     ??DataTable199                    4
     ??DataTable201                    4
     ??DataTable203                    4
     ??DataTable211                    4
     ??DataTable212                    4
     ??DataTable213                    4
     ??DataTable214                    4
     ??DataTable217                    4
     ??DataTable222                    4
     ??DataTable227                    4
     ??DataTable232                    4
     ??DataTable236                    4
     ??DataTable253                    4
     ??DataTable257                    4
     ??DataTable259                    4
     ??DataTable276                    4
     ??DataTable278                    4
     ??DataTable283                    4
     ??DataTable284                    4
     ??DataTable289                    4
     ??DataTable290                    4
     ??DataTable293                    4
     ??DataTable295                    4
     ??DataTable296                    4
     ??DataTable299                    4
     ??DataTable300                    4
     ??DataTable301                    4
     ??DataTable302                    4
     ?<Constant "C:\\David JIANG\\ST MCU...">
                                      92
      Others                          16

 
 6 300 bytes in segment CODE
    92 bytes in segment DATA_C
 
 6 284 bytes of CODE  memory (+ 16 bytes shared)
    92 bytes of CONST memory

Errors: none
Warnings: none
